(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Computation:()=>Di,Dataset:()=>Mi,DatasetBuilder:()=>Wi,DatasetBuilderSource:()=>Bi,DatasetModifier:()=>Ci,Layer:()=>Ei,Math:()=>Ri,Network:()=>Li,NetworkBuilder:()=>xi,Optimizer:()=>Ti,Trainer:()=>zi});const r=require("fs");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"dimensions",null),o(this,"size",0),o(this,"layers",[]),this.dimensions=e}var e,i;return e=t,(i=[{key:"addLayer",value:function(t){return this.size++,this.layers.push(t),this}},{key:"getLayers",value:function(){return this.layers}},{key:"forward",value:function(t){var e=t;return this.layers.forEach((function(t){e=t.forward(e)})),e}},{key:"backward",value:function(t,e,r,n){for(var o=t.cols,i=r.subtract(e),a=this.layers.length-1;a>=0;a-=1)i=this.layers[a].getBackPropagation().propagate(t,o,n,this.layers[a].derivative(i))}},{key:"save",value:function(t){var e={dimensions:this.dimensions,layers:[]};this.layers.forEach((function(t){e.layers.push({type:t.getType(),size:t.getSize(),weights:{W:t.W.data,b:t.b.data}})}));var n=JSON.stringify(e);return new Promise((function(e,o){r.writeFile(t,n,(function(t){t&&(console.error(t),o()),e(n)}))}))}}])&&n(e.prototype,i),t}();function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(){var e,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r={},(e="kernels")in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r}var e,r;return e=t,r=[{key:"addKernel",value:function(t,e){return this.kernels[t]=e,this}},{key:"execute",value:function(t){if(!this.kernels[t])throw new Error("Kernel '".concat(t,"' not exists."));for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return this.kernels[t].apply(null,r)}}],r&&a(e.prototype,r),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function f(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}var y=new(require("gpu.js").GPU)({mode:"gpu"}),h=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=y.createKernel((function(t,e){return t[this.thread.x][this.thread.y]/e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new pt(t.rows,t.cols,r(t.data,e.data))},p=function(t,e){var r=y.createKernel((function(t){return t[this.thread.x][this.thread.y]/this.constants.number})).setOutput([t.rows,t.cols]).setConstants({number:e});return new pt(t.rows,t.cols,r(t.data))},b=function(t){var e=y.createKernel((function(t){return Math.exp(t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]),r=new pt(t.rows,t.cols,e(t.data)),n=new pt(1,t.cols,r.colwiseSum().data).replicate(t.rows,1);return new pt(t.rows,t.cols,h(r,n).data)},d=function(t,e){var r=y.createKernel((function(t){return Math.log(t[this.thread.x][this.thread.y])})).setOutput([e.rows,e.cols]);return new pt(t.rows,t.cols,W(t,new pt(t.rows,t.cols,r(e.data))).data).sum()},v=function(t){var e=y.createKernel((function(t){return 1/(1+Math.exp(-t[this.thread.x][this.thread.y]))})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,e(t.data))},w=function(t,e){var r=y.createKernel((function(t){return Math.log(t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]),n=y.createKernel((function(t){return 1-t[this.thread.x][this.thread.y]})).setOutput([t.rows,t.cols]),o=y.createKernel((function(t){return Math.log(1-t[this.thread.x][this.thread.y])})).setOutput([e.rows,e.cols]);return _(W(t,new pt(t.rows,t.cols,r(t.data))),W(new pt(t.rows,t.cols,n(t.data)),new pt(e.rows,e.cols,o(e.data)))).sum()},m=function(t){var e=y.createKernel((function(t){return 2/(1+Math.exp(-2*t[this.thread.x][this.thread.y]))-1})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,e(t.data))},g=function(t){var e=y.createKernel((function(t){return Math.max(0,t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,e(t.data))},O=function(t){var e=y.createKernel((function(t){return Math.log(1+Math.exp(t[this.thread.x][this.thread.y]))})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,e(t.data))},S=function(t){var e=y.createKernel((function(t){return Math.pow(t[this.thread.x][this.thread.y],2)})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,e(t.data)).sum()},k=function(t){var e=y.createKernel((function(t){return Math.sqrt(t[this.thread.x][this.thread.y]+1e-8)})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,e(t.data))},j=function(t,e){var r=y.createKernel((function(t,e){return e[this.thread.x][this.thread.y]-Math.pow(t[this.thread.x][this.thread.y],2)})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,r(t.data)).sum()},P=function(t,e){if(t.cols!==e.rows)throw new Error("DIMENSIONS error. m1.cols ".concat(t.cols," !== m2.rows ").concat(e.rows,"."));var r=y.createKernel((function(t,e){for(var r=0,n=0;n<this.constants.cols;n++)r+=t[this.thread.x][n]*e[n][this.thread.y];return r})).setOutput([t.rows,e.cols]).setConstants({cols:t.rows});return new pt(t.rows,e.cols,r(t.data,e.data))},_=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=y.createKernel((function(t,e){return t[this.thread.x][this.thread.y]+e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new pt(t.rows,e.cols,r(t.data,e.data))},x=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=y.createKernel((function(t,e){return t[this.thread.x][this.thread.y]-e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new pt(t.rows,e.cols,r(t.data,e.data))},R=function(t,e){var r=y.createKernel((function(){return Math.random()-.5})).setOutput([t.rows,t.cols]).setConstants({parameter:e});return new pt(t.rows,t.cols,r())},E=function(t){var e=y.createKernel((function(){return 0})).setOutput([t.rows,t.cols]);return new pt(t.rows,t.cols,e())},W=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=y.createKernel((function(t,e){return t[this.thread.x][this.thread.y]*e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new pt(t.rows,e.cols,r(t.data,e.data))},T=function(t,e){var r=y.createKernel((function(t){return t[this.thread.x][this.thread.y]*this.constants.number})).setOutput([t.rows,t.cols]).setConstants({number:e});return new pt(t.rows,t.cols,r(t.data))},z=function(t){var e=y.createKernel((function(t){return t[this.thread.y][this.thread.x]})).setOutput([t.cols,t.rows]);return new pt(t.cols,t.rows,e(t.data))},C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=l(e);if(r){var o=l(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return f(this,t)});function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this)).addKernel("multiply",P),t.addKernel("add",_),t.addKernel("subtract",x),t.addKernel("fillRandom",R),t.addKernel("fillZeros",E),t.addKernel("elementWiseMultiply",W),t.addKernel("multiplyNumber",T),t.addKernel("elementWiseDivide",h),t.addKernel("divideNumber",p),t.addKernel("softmaxActivation",b),t.addKernel("softmaxLoss",d),t.addKernel("logisticActivation",v),t.addKernel("logisticLoss",w),t.addKernel("tanhActivation",m),t.addKernel("reluActivation",g),t.addKernel("softplusActivation",O),t.addKernel("penalty",S),t.addKernel("sqrt",k),t.addKernel("purelinLoss",j),t.addKernel("transpose",z),t}return o}(u);function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function M(t,e){return M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},M(t,e)}function B(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}var A=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]/e.data[n][o]}return new pt(t.rows,e.cols,r)},K=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]/e}return new pt(t.rows,t.cols,r)},N=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=1/(1+Math.exp(-t.data[r][n]))}return pt.from(e)},Z=function(t,e){for(var r=[],n=0;n<e.rows;n+=1){r[n]=[];for(var o=0;o<e.cols;o+=1)e.data&&(r[n][o]=Math.log(e.data[n][o]+1e-8))}for(var i=tt(new pt(e.rows,e.cols,r),t),a=[],u=0;u<t.rows;u+=1){a[u]=[];for(var c=0;c<t.cols;c+=1)t.data&&(a[u][c]=1-t.data[u][c])}for(var s=new pt(t.rows,t.cols,a),f=[],l=0;l<e.rows;l+=1){f[l]=[];for(var y=0;y<e.cols;y+=1)e.data&&(f[l][y]=Math.log(1-e.data[l][y]+1e-8))}var h=new pt(e.rows,e.cols,f);return Y(tt(et(i,-1),t),tt(et(h,-1),rt(s,1))).sum()},F=function(t,e){return N(e).multiply(N(e).minusOne())},H=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=(1-Math.exp(-2*t.data[r][n]))/(1+Math.exp(-2*t.data[r][n]))}return pt.from(e)},I=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.max(0,t.data[r][n]))}return new pt(t.rows,t.cols,e)},q=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&(r[n][o]=e.data[n][o]>0?1:0)}return tt(new pt(t.rows,t.cols,r),t)},V=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.log(1+Math.exp(t.data[r][n])))}return new pt(t.rows,t.cols,e)},U=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.pow(t.data[r][n],2))}return new pt(t.rows,t.cols,e).sum()},Q=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.sqrt(t.data[r][n]+1e-8))}return new pt(t.rows,t.cols,e)},X=function(t,e){if(t.cols!==e.rows)throw new Error("DIMENSIONS error. m1.cols ".concat(t.rows," ").concat(t.cols," !== m2.rows ").concat(e.rows," ").concat(e.cols,"."));for(var r=[],n=0;n<t.rows;++n){r[n]=new Array(e.cols);for(var o=0;o<e.cols;++o){r[n][o]=0;for(var i=0;i<t.cols;++i)t.data&&e.data&&(r[n][o]+=t.data[n][i]*e.data[i][o])}}return new pt(t.rows,e.cols,r)},Y=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal. m1.cols ".concat(t.cols," !== m2.cols ").concat(e.cols));for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&e.data&&(r[n][o]=t.data[n][o]+e.data[n][o])}return new pt(t.rows,t.cols,r)},J=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal: m1.rows ".concat(t.rows," !== m2.rows ").concat(e.rows));if(t.cols!==e.cols)throw new Error("COLS number not equal: m1.cols ".concat(t.cols," !== m2.cols ").concat(e.cols));for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&e.data&&(r[n][o]=t.data[n][o]-e.data[n][o])}return new pt(t.rows,t.cols,r)},G=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=(4*Math.random()-2)*Math.sqrt(2/e)}return new pt(t.rows,t.cols,r)},$=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=0}return new pt(t.rows,t.cols,e)},tt=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal: m1.rows ".concat(t.rows," !== m2.rows ").concat(e.rows));if(t.cols!==e.cols)throw new Error("COLS number not equal: m1.cols ".concat(t.cols," !== m2.cols ").concat(e.cols));for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&e.data&&(r[n][o]=t.data[n][o]*e.data[n][o])}return new pt(t.rows,t.cols,r)},et=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&(r[n][o]=t.data[n][o]*e)}return new pt(t.rows,t.cols,r)},rt=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&(r[n][o]=e-t.data[n][o])}return new pt(t.rows,t.cols,r)},nt=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&(r[n][o]=Math.pow(t.data[n][o],e))}return new pt(t.rows,t.cols,r)},ot=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&(r[n][o]=Math.log(t.data[n][o]+1e-8))}return new pt(t.rows,t.cols,r)},it=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)t.data&&(r[n][o]=Math.log(1-t.data[n][o]))}return new pt(t.rows,t.cols,r)},at=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]+e}return new pt(t.rows,t.cols,r)},ut=function(t){for(var e=[],r=0;r<t.cols;r+=1){e[r]=[];for(var n=0;n<t.rows;n+=1)t.data&&(e[r][n]=t.data[n][r])}return new pt(t.cols,t.rows,e)},ct=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=L(e);if(r){var o=L(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return B(this,t)});function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this)).addKernel("multiply",X),t.addKernel("add",Y),t.addKernel("subtract",J),t.addKernel("subtractFromNumber",rt),t.addKernel("fillRandom",G),t.addKernel("fillZeros",$),t.addKernel("elementWiseMultiply",tt),t.addKernel("multiplyNumber",et),t.addKernel("elementWiseDivide",A),t.addKernel("divideNumber",K),t.addKernel("logisticActivation",N),t.addKernel("logisticLoss",Z),t.addKernel("logisticBackpropagation",F),t.addKernel("tanhActivation",H),t.addKernel("reluActivation",I),t.addKernel("reluBackpropagation",q),t.addKernel("softplusActivation",V),t.addKernel("penalty",U),t.addKernel("sqrt",Q),t.addKernel("transpose",ut),t.addKernel("pow",nt),t.addKernel("log",ot),t.addKernel("logMinusOne",it),t.addKernel("addNumber",at),t}return o}(u),st=new ct,ft=function(){return st};function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ht(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var pt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;lt(this,t),ht(this,"rows",0),ht(this,"cols",0),ht(this,"data",null),this.resize(e,r),n&&this.generateData(n)}return e=t,r=[{key:"resize",value:function(t,e){this.rows=t,this.cols=e,this.data=[];for(var r=0;r<this.rows;r+=1)this.data[r]=new Array(this.cols);return this}},{key:"generateData",value:function(t){for(var e=[],r=0;r<this.rows;r+=1)e[r]=new Array(this.cols);for(var n=0;n<this.cols;n+=1)for(var o=0;o<this.rows;o+=1)"number"==typeof t[o]?e[o][n]=t[o]:t[o]instanceof Float32Array||t[o]&&"number"==typeof t[o][n]?e[o][n]=t[o][n]:"string"==typeof t[o][n]?e[o][n]=t[o][n].length?Number(t[o][n]):NaN:e[o][n]=NaN;return this.data=e,this}},{key:"sum",value:function(){for(var t=0,e=0;e<this.rows;e+=1)for(var r=0;r<this.cols;r+=1)t+=this.data[e][r];return t}},{key:"colwiseSum",value:function(){for(var e=[],r=this.transpose(),n=0;n<r.rows;n+=1){e[n]=[0];for(var o=0;o<r.cols;o+=1)e[n][0]+=r.data[n][o]}return new t(this.cols,1,e)}},{key:"rowwiseSum",value:function(){for(var e=[[]],r=0;r<this.rows;r+=1){for(var n=0,o=0;o<this.cols;o+=1)n+=this.data[r][o];e[0].push(n)}return new t(1,this.rows,e)}},{key:"flatten",value:function(){for(var t=[],e=0;e<this.rows;e+=1)for(var r=0;r<this.cols;r+=1)t.push(this.data[e][r]);return t}},{key:"replicate",value:function(e,r){if(1===e&&1===this.cols&&r>1){for(var n=[],o=0;o<this.rows;o+=1){n[o]=[];for(var i=0;i<r;i+=1)n[o][i]=this.data[o][0]}return t.from(n)}if(1===r&&1===this.rows&&e>1){for(var a=[],u=0;u<e;u+=1){a[u]=[];for(var c=0;c<this.cols;c+=1)a[u][c]=this.data[0][c]}return t.from(a)}return this}},{key:"transpose",value:function(){return ft().execute("transpose",this)}},{key:"colMaxCoeffIndex",value:function(t){for(var e=-1,r=-1/0,n=0;n<this.rows;n+=1)this.data&&this.data[n][t]>r&&(r=this.data[n][t],e=n);return e}},{key:"rowMaxCoeffIndex",value:function(t){for(var e=-1,r=-1/0,n=0;n<this.cols;n+=1)this.data[t][n]>r&&(r=this.data[t][n],e=n);return e}},{key:"block",value:function(e,r,n,o){for(var i=[],a=e,u=0;a<this.rows&&a<e+n;a+=1,u+=1){i[u]=new Array(o);for(var c=r,s=0;c<this.cols&&c<r+o;c+=1,s+=1)i[u][s]=this.data[a][c]}return new t(n,o,i)}},{key:"col",value:function(e){for(var r=[],n=0;n<this.rows;n+=1)r[n]=[this.data[n][e]];return new t(this.rows,1,r)}},{key:"row",value:function(e){for(var r=[],n=0;n<this.cols;n+=1)r[n]=[this.data[e][n]];return new t(this.cols,1,r)}},{key:"setCol",value:function(t,e){for(var r=0;r<this.rows;r+=1)this.data&&e.data&&(this.data[r][t]=e.data[r][0]);return this}},{key:"sigmoid",value:function(){return this.multiply(-1).exp().add(1).fraction(1)}},{key:"rollToColMatrix",value:function(){for(var e=[],r=0,n=0;n<this.rows;n+=1)for(var o=0;o<this.cols;o+=1)e[r]=[],e[r++][0]=this.data[n][o];return t.from(e)}},{key:"abs",value:function(){for(var e=[],r=0;r<this.rows;r+=1){e[r]=[];for(var n=0;n<this.cols;n+=1)e[r][n]=Math.abs(this.data[r][n])}return t.from(e)}},{key:"mean",value:function(){for(var t=0,e=this.rows*this.cols,r=0;r<this.rows;r+=1)for(var n=0;n<this.cols;n+=1)t+=this.data[r][n];return t/e}},{key:"max",value:function(){for(var t=-1/0,e=0;e<this.rows;e+=1)for(var r=0;r<this.cols;r+=1)t=Math.max(this.data[e][r],t);return t}},{key:"setMax",value:function(e){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=Math.min(this.data[n][o],e)}return t.from(r)}},{key:"setMin",value:function(e){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=Math.max(this.data[n][o],e)}return t.from(r)}},{key:"setZeros",value:function(){for(var e=[],r=0;r<this.rows;r+=1){e[r]=[];for(var n=0;n<this.cols;n+=1)e[r][n]=0}return t.from(e)}},{key:"setOnes",value:function(){for(var e=[],r=0;r<this.rows;r+=1){e[r]=[];for(var n=0;n<this.cols;n+=1)e[r][n]=1}return t.from(e)}},{key:"setRandom",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=(4*Math.random()-2)*Math.sqrt(2/e)}return t.from(r)}},{key:"fraction",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=e/this.data[n][o]}return t.from(r)}},{key:"sqrt",value:function(){for(var e=[],r=0;r<this.rows;r+=1){e[r]=[];for(var n=0;n<this.cols;n+=1)e[r][n]=Math.sqrt(this.data[r][n]+1e-8)}return t.from(e)}},{key:"dot",value:function(t){return ft().execute("multiply",this,t)}},{key:"multiply",value:function(e){if("number"==typeof e){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=this.data[n][o]*e}return t.from(r)}for(var i=[],a=0;a<this.rows;a+=1){i[a]=[];for(var u=0;u<this.cols;u+=1)i[a][u]=this.data[a][u]*e.data[a][u]}return t.from(i)}},{key:"subtract",value:function(e){if(e instanceof t){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=this.data[n][o]-e.data[n][o]}return t.from(r)}for(var i=[],a=0;a<this.rows;a+=1){i[a]=[];for(var u=0;u<this.cols;u+=1)i[a][u]=this.data[a][u]-e}return t.from(i)}},{key:"forEach",value:function(t){for(var e=0;e<this.rows;e+=1)for(var r=0;r<this.cols;r+=1)t(this.data[e][r]);return this}},{key:"shape",value:function(){return[this.rows,this.cols]}},{key:"divide",value:function(e){if("number"==typeof e){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=this.data[n][o]/e}return t.from(r)}if(e.rows!==this.rows||e.cols!==this.cols)throw new Error("Dimensions error (".concat(this.rows,", ").concat(this.cols,") !== (").concat(e.rows,", ").concat(e.cols,")"));for(var i=[],a=0;a<this.rows;a+=1){i[a]=[];for(var u=0;u<this.cols;u+=1)i[a][u]=this.data[a][u]/e.data[a][u]}return t.from(i)}},{key:"minusOne",value:function(){for(var e=[],r=0;r<this.rows;r+=1){e[r]=[];for(var n=0;n<this.cols;n+=1)e[r][n]=1-this.data[r][n]}return t.from(e)}},{key:"subtractFromNumber",value:function(e){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=e-this.data[n][o]}return t.from(r)}},{key:"add",value:function(e){if("number"==typeof e){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=this.data[n][o]+e}return t.from(r)}if(e instanceof t){if(e.rows!==this.rows||e.cols!==this.cols)throw new Error("Dimention error: rows (x: ".concat(this.rows,", y: ").concat(this.cols,") !== (x: ").concat(e.rows,", y: ").concat(e.cols,")"));for(var i=[],a=0;a<this.rows;a+=1){i[a]=[];for(var u=0;u<this.cols;u+=1)i[a][u]=this.data[a][u]+e.data[a][u]}return t.from(i)}return this}},{key:"log",value:function(){for(var e=[],r=0;r<this.rows;r+=1){e[r]=[];for(var n=0;n<this.cols;n+=1)e[r][n]=Math.log(this.data[r][n]+1e-8)}return t.from(e)}},{key:"tanh",value:function(){return this.exp().subtract(this.multiply(-1).exp()).divide(this.exp().add(this.multiply(-1).exp()))}},{key:"softmax",value:function(){var t=this.max()-1e-8;return this.subtract(t).exp().divide(this.rowwiseSum().replicate(this.cols,1).transpose())}},{key:"exp",value:function(){for(var e=[],r=0;r<this.rows;r+=1){e[r]=[];for(var n=0;n<this.cols;n+=1)e[r][n]=Math.exp(this.data[r][n]+1e-8)}return t.from(e)}},{key:"pow",value:function(e){for(var r=[],n=0;n<this.rows;n+=1){r[n]=[];for(var o=0;o<this.cols;o+=1)r[n][o]=Math.pow(this.data[n][o],e)}return t.from(r)}}],n=[{key:"from",value:function(e){var r;return new t(e.length,(null===(r=e[0])||void 0===r?void 0:r.length)||0,e)}}],r&&yt(e.prototype,r),n&&yt(e,n),t;var e,r,n}();function bt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return dt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mt,gt,Ot=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),wt(this,"dimensions",null),wt(this,"size",0),wt(this,"layers",[]),this.dimensions=e}var e,r;return e=t,(r=[{key:"addLayer",value:function(t){return this.size++,this.layers.push(t),this}},{key:"getLayers",value:function(){return this.layers}},{key:"loss",value:function(t,e){return-Math.log(1/t)*e}},{key:"sample",value:function(t){for(var e=this.layers[0].Waa,r=this.layers[0].Wax,n=this.layers[0].Wya,o=this.layers[0].by,i=this.layers[0].b,a=(t.getVocabularySize(),[]),u=t.getCharIndices(),c=u["\n"],s=t.getChars(),f=new pt(27,1).setZeros(),l=new pt(100,1).setZeros(),y=-1,h=0;y!=c&&50!=h;){var p=r.dot(f).add(e.dot(l)).add(i).tanh(),b=n.dot(p).add(o).softmax();y=u[s[b.colMaxCoeffIndex(0)]],a.push(y),(f=new pt(27,1).setZeros()).data[b.colMaxCoeffIndex(0)][0]=1,l=p,h+=1}return a.map((function(t){return s[t]})).join("")}},{key:"forward",value:function(t,e,r){for(var n=[null],o=[r],i=[null],a=0,u=1;u<=t.rows;u+=1){n[u]=new pt(27,1).setZeros(),n[u].data[t.rowMaxCoeffIndex(u-1)][0]=1;var c=bt(this.layers[0].forward(o[u-1],n[u]),2),s=c[0],f=c[1];o[u]=s,i[u]=f.setMin(1e-5),a-=Math.log(i[u].data[u-1][0])}return this.layers[0].A=o,this.layers[0].X=n,this.layers[0].Y=i,[a]}},{key:"backward",value:function(t,e){var r=this.layers[0].A,n=this.layers[0].X,o=this.layers[0].Y;this.layers[0].dWax=new pt(this.layers[0].Wax.rows,this.layers[0].Wax.cols).setZeros(),this.layers[0].dWaa=new pt(this.layers[0].Waa.rows,this.layers[0].Waa.cols).setZeros(),this.layers[0].dWya=new pt(this.layers[0].Wya.rows,this.layers[0].Wya.cols).setZeros(),this.layers[0].db=new pt(this.layers[0].b.rows,this.layers[0].b.cols).setZeros(),this.layers[0].dby=new pt(this.layers[0].by.rows,this.layers[0].by.cols).setZeros();for(var i=t.rows-1;i>=1;i-=1){var a=pt.from(o[i].data);this.layers[0].backward(a,n[i],r[i],r[i-1])}}},{key:"optimize",value:function(t,e,r,n){var o=bt(this.forward(t,e,r),1)[0];return this.backward(t,e),this.layers[0].Wax=this.layers[0].Wax.add(this.layers[0].dWax.multiply(-n)),this.layers[0].Waa=this.layers[0].Waa.add(this.layers[0].dWaa.multiply(-n)),this.layers[0].Wya=this.layers[0].Wya.add(this.layers[0].dWya.multiply(-n)),this.layers[0].b=this.layers[0].b.add(this.layers[0].db.multiply(-n)),this.layers[0].by=this.layers[0].by.add(this.layers[0].dby.multiply(-n)),[o,this.layers[0].A[t.rows-1]]}}])&&vt(e.prototype,r),t}();function St(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}(gt=mt||(mt={})).logistic="logistic",gt.softmax="softmax",gt.tanh="tanh",gt.relu="relu",gt.softplus="softplus",gt.conv="conv",gt.maxpool="maxpool",gt.fullyconnected="fullyconnected",gt.purelin="purelin",gt.rnnlayer="rnnlayer";var kt=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),St(this,"layer",null),St(this,"previousLayer",null),this.layer=e,this.previousLayer=r};function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xt(t,e){return xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},xt(t,e)}function Rt(t,e){if(e&&("object"===jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Et(t){return Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Et(t)}var Wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Et(n);if(o){var r=Et(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Rt(this,t)});function a(){return Pt(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"propagate",value:function(t,e,r,n){var o=null!==this.previousLayer?this.previousLayer.A:t;if(this.layer.gW=n.dot(o.transpose()).divide(e),this.layer.gW=this.layer.gW.add(this.layer.W.multiply(r).divide(e)),this.layer.gb=n.rowwiseSum().transpose().divide(e),null!==this.previousLayer){var i=this.layer.W.transpose().dot(n);if(i.rows!==o.rows||i.cols!==o.cols)throw console.log(this.layer.W.rows,this.layer.W.cols,n.rows,n.cols,this.layer.gW.rows,this.layer.gW.cols),new Error("Dimension error 1. (".concat(i.rows,", ").concat(i.cols,") | (").concat(o.rows,", ").concat(o.cols,")"));if(this.layer.gW.rows!==this.layer.W.rows||this.layer.gW.cols!==this.layer.W.cols)throw new Error("Dimension error 2. (".concat(this.layer.gW.rows,", ").concat(this.layer.gW.cols,") | (").concat(this.layer.W.rows,", ").concat(this.layer.W.cols,")"));if(this.layer.gb.rows!==this.layer.b.rows||this.layer.gb.cols!==this.layer.b.cols)throw new Error("Dimension error 3. (".concat(this.layer.gb.rows,", ").concat(this.layer.gb.cols,") | (").concat(this.layer.b.rows,", ").concat(this.layer.b.cols,")"));return i}return new pt}}])&&_t(e.prototype,r),a}(kt);function Tt(t){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(t)}function zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Dt(t,e){return Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Dt(t,e)}function Mt(t,e){if(e&&("object"===Tt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}var Lt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Bt(n);if(o){var r=Bt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Mt(this,t)});function a(){return zt(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"propagate",value:function(t,e,r,n){return n}}])&&Ct(e.prototype,r),a}(kt);function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Kt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Zt(t,e){return Zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Zt(t,e)}function Ft(t,e){if(e&&("object"===At(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ht(t)}function Ht(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function It(t){return It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},It(t)}function qt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=It(n);if(o){var r=It(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ft(this,t)});function a(){var t;Kt(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return qt(Ht(t=i.call.apply(i,[this].concat(r))),"previousLayer",null),t}return e=a,(r=[{key:"propagate",value:function(t,e,r,n){var o=this.previousLayer;if(o){for(var i=ft().execute("fillZeros",new pt(o.Z.rows,o.Z.cols)),a=o.getFilterSize(),u=o.getStride(),c=o.getWidth(),s=o.getHeight(),f=(o.getDepth(),o.getOutputWidth()),l=o.getOutputHeight(),y=o.getOutputDepth(),h=0;h<e;h++)for(var p=0;p<y;p++)for(var b=0;b<l;b++)for(var d=0;d<f;d++){for(var v=u*d,w=-1/0,m=s*c*p,g=l*f*p,O=0,S=0,k=0,j=u*b;k<a;k++,j++)for(var P=0,_=v;P<a;P++,_++)o.Z.data&&w<o.Z.data[m+j*c+_][h]&&(w=o.Z.data[m+j*c+_][h],O=_,S=j);i.data&&n.data&&(i.data[m+S*c+O][h]=n.data[g+b*f+d][h])}return i}return new pt}}])&&Nt(e.prototype,r),a}(kt);function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function Qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yt(t,e){return Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Yt(t,e)}function Jt(t,e){if(e&&("object"===Ut(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Gt(t)}function Gt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}function te(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ee=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=$t(n);if(o){var r=$t(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Jt(this,t)});function a(){var t;Qt(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return te(Gt(t=i.call.apply(i,[this].concat(r))),"previousLayer",null),t}return e=a,(r=[{key:"propagate",value:function(t,e,r,n){var o=this.previousLayer;if(o){var i=o.getPadding(),a=o.getStride(),u=o.getFilterSize(),c=o.getOutputWidth(),s=o.getOutputHeight(),f=o.getOutputDepth(),l=o.getWidth(),y=o.getHeight(),h=o.getDepth(),p=ft().execute("fillZeros",new pt((l+2*i)*(y+2*i)*h,e)),b=new pt(l*y*h,e);o.gW=ft().execute("fillZeros",o.gW),o.gb=ft().execute("fillZeros",o.gb);for(var d=0;d<e;d++){for(var v=0;v<f;v++)for(var w=0;w<s;w++)for(var m=0;m<c;m++){for(var g=a*w,O=a*m,S=0;S<h;S++)for(var k=0,j=g,P=-i;k<u;k++,j++,P++)for(var _=0,x=O,R=-i;_<u;_++,x++,R++){o.W.data&&p.data&&n.data&&(p.data[S*(l+2*i)*(y+2*i)+j*(l+2*i)+x][d]+=o.W.data[v][S*u*u+k*u+_]*n.data[v*c*s+w*c+m][d]);var E=0;0==i?o.Z.data&&(E=o.Z.data[S*l*y+j*l+x][d]):P>=0&&R>=0&&P<y&&R<l&&o.Z.data&&(E=o.Z.data[S*l*y+P*l+R][d]),o.gW.data&&n.data&&(o.gW.data[v][S*u*u+k*u+_]+=E*n.data[v*(c*s)+w*c+m][d]/e)}o.gb.data&&n.data&&(o.gb.data[v][0]+=n.data[v*(c*s)+w*c+m][d]/e)}if(i>0)for(var W=0;W<h;W++)for(var T=-i,z=0;T<y+i;T++,z++)for(var C=-i,D=0;C<l+i;C++,D++)C>=0&&T>=0&&C<l&&T<y&&b.data&&p.data&&(b.data[W*l*y+T*l+C][d]=p.data[W*(l+2*i)*(y+2*i)+z*(l+2*i)+D][d])}return i>0?b:p}}}])&&Xt(e.prototype,r),a}(kt);function re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ne=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"create",value:function(t,e){if(null==t){if(e.is1D())return new Wt(e,t);if(e.getType()==mt.conv)return new Lt(e,t)}else{if(t.getType()==mt.maxpool)return new Vt(e,t);if(t.getType()==mt.conv)return new ee(e,t);if(t.is1D()||t.getType()==mt.fullyconnected)return new Wt(e,t)}return null}}],null&&re(e.prototype,null),r&&re(e,r),t}();function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ae=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ie(this,"dimensions",null),ie(this,"lastLayer",null),ie(this,"network",null),this.dimensions=e,this.network=new i(e)}var e,r;return e=t,r=[{key:"createLayer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new t;return"function"==typeof e&&e(r),null===this.lastLayer?this.firstLayerTransition(r):r.transition(this.lastLayer),r.configure(),r.setBackPropagation(ne.create(this.lastLayer,r)),this.network.addLayer(r),this.lastLayer=r,this}},{key:"getNetwork",value:function(){return this.network}}],r&&oe(e.prototype,r),t}();function ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ce(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var se=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ce(this,"width",0),ce(this,"height",0),ce(this,"depth",0),ce(this,"previousLayer",null),ce(this,"backPropagation",null)}var e,r;return e=t,(r=[{key:"setBackPropagation",value:function(t){return this.backPropagation=t,this}},{key:"getBackPropagation",value:function(){return this.backPropagation}},{key:"setWidth",value:function(t){return this.width=t,this}},{key:"getWidth",value:function(){return this.width}},{key:"setHeight",value:function(t){return this.height=t,this}},{key:"getHeight",value:function(){return this.height}},{key:"setDepth",value:function(t){return this.depth=t,this}},{key:"getDepth",value:function(){return this.depth}},{key:"transition",value:function(t){return this.previousLayer=t,this}}])&&ue(e.prototype,r),t}();function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ye(t,e,r){return ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=de(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}},ye(t,e,r||t)}function he(t,e){return he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},he(t,e)}function pe(t,e){if(e&&("object"===fe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return be(t)}function be(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}var ve=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&he(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=de(n);if(o){var r=de(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return pe(this,t)});function a(){var t,e,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),1,(r="depth")in(e=be(t=i.call(this)))?Object.defineProperty(e,r,{value:1,enumerable:!0,configurable:!0,writable:!0}):e[r]=1,t.W=new pt,t.b=new pt,t.A=new pt,t.Z=new pt,t.gW=new pt,t.gb=new pt,t.vW=new pt,t.vb=new pt,t.sW=new pt,t.sb=new pt,t.dW=new pt,t.db=new pt,t}return e=a,(r=[{key:"configure",value:function(){this.W.resize(this.getHeight(),this.getWidth()),this.W=this.W.setRandom(this.previousLayer?this.previousLayer.getHeight():this.getHeight()),this.b.resize(this.getHeight(),1),this.b=this.b.setRandom(this.previousLayer?this.previousLayer.getHeight():this.getHeight()),this.gW.resize(this.getHeight(),this.getWidth()),this.gW=this.W.setZeros(),this.gb.resize(this.getHeight(),1),this.gb=this.gb.setZeros(),this.sW.resize(this.getHeight(),this.getWidth()),this.sW=this.sW.setZeros(),this.sb.resize(this.getHeight(),1),this.sb=this.sb.setZeros(),this.vW.resize(this.getHeight(),this.getWidth()),this.vW=this.vW.setZeros(),this.vb.resize(this.getHeight(),1),this.vb=this.vb.setZeros(),this.dW.resize(this.getHeight(),this.getWidth()),this.dW=this.dW.setZeros(),this.db.resize(this.getHeight(),1),this.db=this.db.setZeros()}},{key:"forward",value:function(t){return this.Z=this.W.dot(t).add(this.b.replicate(1,t.cols)),this.A=this.activation(this.Z),this.A}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){return t.is1D()?this.setWidth(t.getSize()):t.is3D()&&this.setWidth(t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth()),ye(de(a.prototype),"transition",this).call(this,t),this}},{key:"setSize",value:function(t){return this.setHeight(t),this}},{key:"getSize",value:function(){return this.height}},{key:"getOutputWidth",value:function(){return this.width}},{key:"getOutputHeight",value:function(){return this.height}},{key:"getOutputDepth",value:function(){return 1}},{key:"penalty",value:function(){return this.W.pow(2).sum()}}])&&le(e.prototype,r),a}(se);function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function me(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Oe(t,e){return Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Oe(t,e)}function Se(t,e){if(e&&("object"===we(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ke(t){return ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ke(t)}var je=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ke(n);if(o){var r=ke(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Se(this,t)});function a(){return me(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"activation",value:function(t){return t.softmax()}},{key:"getType",value:function(){return mt.softmax}},{key:"derivative",value:function(t){return t.multiply(-1).add(1).fraction(1)}}])&&ge(e.prototype,r),a}(ve);function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function _e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Re(t,e){return Re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Re(t,e)}function Ee(t,e){if(e&&("object"===Pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function We(t){return We=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},We(t)}var Te=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Re(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=We(n);if(o){var r=We(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ee(this,t)});function a(){return _e(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"activation",value:function(t){return t.multiply(-1).exp().add(1).fraction(1)}},{key:"getType",value:function(){return mt.logistic}},{key:"derivative",value:function(t){return t.multiply(this.activation(t).multiply(this.activation(t.minusOne())))}}])&&xe(e.prototype,r),a}(ve);function ze(t){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(t)}function Ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Me(t,e){return Me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Me(t,e)}function Be(t,e){if(e&&("object"===ze(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Le(t){return Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Le(t)}var Ae=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Me(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Le(n);if(o){var r=Le(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Be(this,t)});function a(){return Ce(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"activation",value:function(t){return t.tanh()}},{key:"getType",value:function(){return mt.tanh}},{key:"derivative",value:function(t){return this.activation(t).pow(2).minusOne()}}])&&De(e.prototype,r),a}(ve);function Ke(t){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(t)}function Ne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Fe(t,e){return Fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Fe(t,e)}function He(t,e){if(e&&("object"===Ke(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ie(t){return Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ie(t)}var qe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fe(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ie(n);if(o){var r=Ie(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return He(this,t)});function a(){return Ne(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"activation",value:function(t){return t.setMax(0)}},{key:"getType",value:function(){return mt.relu}},{key:"derivative",value:function(t){return ft().execute("reluBackpropagation",t,this.A)}}])&&Ze(e.prototype,r),a}(ve);function Ve(t){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ve(t)}function Ue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xe(t,e){return Xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xe(t,e)}function Ye(t,e){if(e&&("object"===Ve(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Je(t){return Je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Je(t)}var Ge=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xe(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Je(n);if(o){var r=Je(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ye(this,t)});function a(){return Ue(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"activation",value:function(t){return t.exp().add(1).log()}},{key:"getType",value:function(){return mt.softplus}},{key:"derivative",value:function(t){return t.multiply(-1).exp().add(1).fraction(1)}}])&&Qe(e.prototype,r),a}(ve),$e=function(t,e,r,n,o,i,a,u,c,s){for(var f=0,l=new pt(((n-i+2*u)/s+1)*((r-o+2*a)/c+1),i*o*e).setZeros(),y=-a;y+o<=r+a;y+=c)for(var h=-u;h+i<=n+u;h+=s){for(var p=0,b=0;b<e;b++)for(var d=r*n*b,v=0;v<o;v++)for(var w=0;w<i;w++)y+v>=0&&h+w>=0&&h+w<n&&y+v<r&&(l.data[f][p]=t.data[(v+y)*n+h+w+d][0]),p++;f++}return l},tr=function(t,e,r,n,o,i,a,u){for(var c=(n-i)/u+1,s=(r-o)/a+1,f=0,l=new pt(c*s*e,1).setZeros(),y=0;y+o<=r;y+=a)for(var h=0;h+i<=n;h+=u){for(var p=0;p<e;p++){for(var b=-1/0,d=r*n*p,v=c*s*p,w=0;w<o;w++)for(var m=0;m<i;m++)b=Math.max(b,t.data[d+(w+y)*n+h+m][0]);l.data[v+f][0]=b}f++}return l},er=function(t,e){return Math.round((t+Number.EPSILON)*Math.pow(10,e))/Math.pow(10,e)};function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function nr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function or(t,e,r){return or="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ur(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}},or(t,e,r||t)}function ir(t,e){return ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ir(t,e)}function ar(t,e){if(e&&("object"===rr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ur(t){return ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ur(t)}var cr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ir(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ur(n);if(o){var r=ur(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ar(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).W=new pt,t.b=new pt,t.A=new pt,t.Z=new pt,t.gW=new pt,t.gb=new pt,t.vW=new pt,t.vb=new pt,t.sW=new pt,t.sb=new pt,t.dW=new pt,t.db=new pt,t}return e=a,(r=[{key:"configure",value:function(){}},{key:"is1D",value:function(){return!1}},{key:"is3D",value:function(){return!0}},{key:"transition",value:function(t){return t.is3D()&&this.setSize([t.getOutputWidth(),t.getOutputHeight(),t.getOutputDepth()]),or(ur(a.prototype),"transition",this).call(this,t),this}},{key:"setSize",value:function(t){return this.setWidth(t[0]),this.setHeight(t[1]),this.setDepth(t[2]),this}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight(),this.getDepth()]}},{key:"penalty",value:function(){return this.W.pow(2).sum()}}])&&nr(e.prototype,r),a}(se);function sr(t){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sr(t)}function fr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yr(t,e){return yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yr(t,e)}function hr(t,e){if(e&&("object"===sr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return pr(t)}function pr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function br(t){return br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},br(t)}function dr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var vr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=br(n);if(o){var r=br(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return hr(this,t)});function a(){var t;fr(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return dr(pr(t=i.call.apply(i,[this].concat(r))),"numFilters",32),dr(pr(t),"filterSize",4),dr(pr(t),"padding",1),dr(pr(t),"stride",1),t}return e=a,(r=[{key:"configure",value:function(){this.W.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.W=this.W.setRandom(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth()),this.b.resize(this.numFilters,1),this.b=this.b.setRandom(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth()),this.gW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.gW=this.gW.setZeros(),this.gb.resize(this.numFilters,1),this.gb=this.gb.setZeros(),this.sW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.sW=this.sW.setZeros(),this.sb.resize(this.numFilters,1),this.sb=this.sb.setZeros(),this.vW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.vW=this.vW.setZeros(),this.vb.resize(this.numFilters,1),this.vb=this.vb.setZeros()}},{key:"getOutputHeight",value:function(){return(this.width-this.filterSize+2*this.padding)/this.stride+1}},{key:"getOutputWidth",value:function(){return(this.height-this.filterSize+2*this.padding)/this.stride+1}},{key:"getOutputDepth",value:function(){return this.numFilters}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"getFilterSize",value:function(){return this.filterSize}},{key:"setNumFilters",value:function(t){return this.numFilters=t,this}},{key:"getNumFilters",value:function(){return this.numFilters}},{key:"setPadding",value:function(t){return this.padding=t,this}},{key:"getPadding",value:function(){return this.padding}},{key:"setStride",value:function(t){return this.stride=t,this}},{key:"getStride",value:function(){return this.stride}},{key:"forward",value:function(t){for(var e=new pt(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth(),t.cols).setZeros(),r=0;r<t.cols;r+=1){var n=$e(t.col(r),this.depth,this.height,this.width,this.filterSize,this.filterSize,this.padding,this.padding,this.stride,this.stride),o=this.W.dot(n.transpose()).add(this.b.replicate(1,n.rows));e.setCol(r,o.rollToColMatrix())}return this.Z=e,this.A=this.activation(this.Z),this.A}},{key:"activation",value:function(t){return t.setMin(0)}},{key:"getType",value:function(){return mt.conv}},{key:"derivative",value:function(t){return ft().execute("reluBackpropagation",t,this.A)}}])&&lr(e.prototype,r),a}(cr);function wr(t){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wr(t)}function mr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Or(t,e){return Or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Or(t,e)}function Sr(t,e){if(e&&("object"===wr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function kr(t){return kr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},kr(t)}var jr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Or(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=kr(n);if(o){var r=kr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Sr(this,t)});function a(){return mr(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"transition",value:function(t){if(!t.is3D())throw new Error("Invalid usage. Cannot fully connect with previous 1D Layer.");if(t.getType()!=mt.maxpool)throw new Error("Invalid usage. Cannot fully connect with previous non maxpool Layer.");return this.filterSize=t.getOutputWidth(),this.padding=0,this.stride=1,this.width=t.getOutputWidth(),this.height=t.getOutputHeight(),this.depth=t.getOutputDepth(),this.numFilters=t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth(),this}},{key:"setSize",value:function(t){return this}},{key:"setFilterSize",value:function(t){return this}},{key:"setStride",value:function(t){return this}},{key:"setPadding",value:function(t){return this}},{key:"setWidth",value:function(t){return this}},{key:"setHeight",value:function(t){return this}},{key:"setDepth",value:function(t){return this}},{key:"setNumFilters",value:function(t){return this}}])&&gr(e.prototype,r),a}(vr);function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function _r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rr(t,e){return Rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Rr(t,e)}function Er(t,e){if(e&&("object"===Pr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wr(t)}function Wr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tr(t){return Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tr(t)}function zr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Cr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rr(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Tr(n);if(o){var r=Tr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Er(this,t)});function a(){var t;_r(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return zr(Wr(t=i.call.apply(i,[this].concat(r))),"filterSize",0),zr(Wr(t),"stride",0),t}return e=a,(r=[{key:"configure",value:function(){}},{key:"getOutputHeight",value:function(){return(this.height-this.filterSize)/this.stride+1}},{key:"getOutputWidth",value:function(){return(this.width-this.filterSize)/this.stride+1}},{key:"getOutputDepth",value:function(){return this.depth}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"getFilterSize",value:function(){return this.filterSize}},{key:"setStride",value:function(t){return this.stride=t,this}},{key:"getStride",value:function(){return this.stride}},{key:"getPadding",value:function(){return 0}},{key:"forward",value:function(t){for(var e=new pt(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth(),t.cols),r=0;r<t.cols;r+=1){var n=tr(t.col(r),this.depth,this.height,this.width,this.filterSize,this.filterSize,this.stride,this.stride);e.setCol(r,n.rollToColMatrix())}return this.Z=e,this.A=this.activation(this.Z),this.A}},{key:"activation",value:function(t){return t}},{key:"getType",value:function(){return mt.maxpool}},{key:"derivative",value:function(t){return t}}])&&xr(e.prototype,r),a}(cr);function Dr(t){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dr(t)}function Mr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Br(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lr(t,e){return Lr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Lr(t,e)}function Ar(t,e){if(e&&("object"===Dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Kr(t)}function Kr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nr(t){return Nr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Nr(t)}function Zr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Fr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lr(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Nr(n);if(o){var r=Nr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ar(this,t)});function a(){var t;Mr(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Zr(Kr(t=i.call.apply(i,[this].concat(r))),"Wax",null),Zr(Kr(t),"Waa",null),Zr(Kr(t),"Wya",null),Zr(Kr(t),"b",null),Zr(Kr(t),"by",null),Zr(Kr(t),"dWax",null),Zr(Kr(t),"dWaa",null),Zr(Kr(t),"dWya",null),Zr(Kr(t),"db",null),Zr(Kr(t),"dby",null),Zr(Kr(t),"Y",[]),Zr(Kr(t),"A",[]),Zr(Kr(t),"X",[]),Zr(Kr(t),"daNext",null),Zr(Kr(t),"dxt",null),t}return e=a,(r=[{key:"configure",value:function(){this.Wax=new pt(100,27),this.Wax=this.Wax.setRandom(1),this.Waa=new pt(100,100),this.Waa=this.Waa.setRandom(1),this.Wya=new pt(27,100),this.Wya=this.Wya.setRandom(1),this.b=new pt(100,1),this.b=this.b.setRandom(1),this.by=new pt(27,1),this.by=this.by.setRandom(1),this.dWax=new pt(100,27),this.dWax=this.dWax.setZeros(),this.dWaa=new pt(100,100),this.dWaa=this.dWaa.setZeros(),this.dWya=new pt(27,100),this.dWya=this.dWya.setZeros(),this.db=new pt(100,1),this.db=this.db.setZeros(),this.dby=new pt(27,1),this.dby=this.dby.setZeros()}},{key:"forward",value:function(t,e){var r=this.Waa.dot(t).add(this.Wax.dot(e)).add(this.b).tanh(),n=this.Wya.dot(r).add(this.by).softmax();return this.A.push(r),this.X.push(e),this.Y.push(n),[r,n]}},{key:"backward",value:function(t,e,r,n){this.dWya=this.dWya.add(t.dot(r.transpose())).setMax(5).setMin(-5),this.dby=this.dby.add(t).setMax(5).setMin(-5);var o=this.Wya.transpose().dot(t).add(this.daNext),i=r.multiply(r).minusOne().multiply(o);this.db=this.db.add(i).setMax(5).setMin(-5),this.dWax=this.dWax.add(i.dot(e.transpose())).setMax(5).setMin(-5),this.dWaa=this.dWaa.add(i.dot(n.transpose())).setMax(5).setMin(-5),this.daNext=this.Waa.transpose().dot(i).setMax(5).setMin(-5)}},{key:"activation",value:function(t){return t}},{key:"getType",value:function(){return mt.rnnlayer}},{key:"derivative",value:function(t){return t}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"setSize",value:function(t){return this.setWidth(t[0]),this.setHeight(t[1]),this.setDepth(t[2]),this}},{key:"getSize",value:function(){return this.height}},{key:"getOutputWidth",value:function(){return this.width}},{key:"getOutputHeight",value:function(){return this.height}},{key:"getOutputDepth",value:function(){return this.depth}},{key:"penalty",value:function(){return 0}},{key:"getWidth",value:function(){return this.width}}])&&Br(e.prototype,r),a}(se);function Hr(t){return Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hr(t)}function Ir(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vr(t,e){return Vr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Vr(t,e)}function Ur(t,e){if(e&&("object"===Hr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Qr(t){return Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Qr(t)}var Xr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vr(t,e)}(c,t);var e,n,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qr(i);if(a){var r=Qr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ur(this,t)});function c(){return Ir(this,c),u.apply(this,arguments)}return e=c,o=[{key:"fromJSON",value:function(t){return new Promise((function(e,n){r.readFile(t,(function(t,r){if(t)n(t);else{var o=JSON.parse(r.toString()),i=new c(o.dimensions);o.layers.forEach((function(t){var e=null;"logistic"===t.type?e=Te:"softmax"===t.type?e=je:"relu"===t.type?e=qe:"softplus"===t.type?e=Ge:"tanh"===t.type&&(e=Ae),i.createLayer(e,(function(e){e.setSize(t.size)}))}));var a=i.getNetwork();a.getLayers().forEach((function(t,e){t.W=new pt(o.layers[e].weights.W.length,o.layers[e].weights.W[0].length,o.layers[e].weights.W),t.b=new pt(o.layers[e].weights.b.length,o.layers[e].weights.b[0].length,o.layers[e].weights.b)})),e(a)}}))}))}}],(n=[{key:"firstLayerTransition",value:function(t){t.setWidth(this.dimensions[0])}}])&&qr(e.prototype,n),o&&qr(e,o),c}(ae);function Yr(t){return Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yr(t)}function Jr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $r(t,e){return $r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},$r(t,e)}function tn(t,e){if(e&&("object"===Yr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function en(t){return en=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},en(t)}var rn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$r(t,e)}(c,t);var e,n,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=en(i);if(a){var r=en(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return tn(this,t)});function c(){return Jr(this,c),u.apply(this,arguments)}return e=c,o=[{key:"fromJSON",value:function(t){return new Promise((function(e,n){r.readFile(t,(function(t,r){if(t)n(t);else{var o=JSON.parse(r.toString()),i=new c(o.size);o.layers.forEach((function(t){"logistic"===t.type?i.createLayer(Te,(function(e){e.setSize(t.size)})):"softmax"===t.type?i.createLayer(je,(function(e){e.setSize(t.size)})):"relu"===t.type?i.createLayer(qe,(function(e){e.setSize(t.size)})):"softplus"===t.type?i.createLayer(Ge,(function(e){e.setSize(t.size)})):"tanh"===t.type?i.createLayer(Ae,(function(e){e.setSize(t.size)})):"conv"===t.type?i.createLayer(vr,(function(e){e.setSize(t.size),e.setFilterSize(t.filterSize),e.setStride(t.stride),e.setNumFilters(t.numFilters),e.setPadding(t.padding)})):"maxpool"===t.type?i.createLayer(Cr,(function(e){e.setSize(t.size),e.setFilterSize(t.filterSize),e.setStride(t.stride)})):"fullyconnected"===t.type&&i.createLayer(Cr)}));var a=i.getNetwork();a&&(a.getLayers().forEach((function(t,e){t.W=o.layers.W,t.b=o.layers.b})),e(a))}}))}))}}],(n=[{key:"firstLayerTransition",value:function(t){this.dimensions&&t.setSize(this.dimensions)}}])&&Gr(e.prototype,n),o&&Gr(e,o),c}(ae);function nn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function on(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function an(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var un=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(nn(this,t),an(this,"exampleSize",0),an(this,"numberOfExamples",0),an(this,"data",null),this.exampleSize=e,this.numberOfExamples=r,n){for(var o=[],i=0;i<e;i+=1){o[i]=new Array(r);for(var a=0;a<r;a+=1)"string"==typeof n[i][a]?o[i][a]=n[i][a].length?Number(n[i][a]):NaN:"number"==typeof n[i][a]&&(o[i][a]=n[i][a])}this.data=new pt(this.exampleSize,this.numberOfExamples,o)}}var e,r,n;return e=t,n=[{key:"fromMatrix",value:function(e){var r=new t;return r.exampleSize=e.rows,r.numberOfExamples=e.cols,r.data=e,r}}],(r=[{key:"exampleAt",value:function(t){return this.data.col(t)}},{key:"getNumberOfExamples",value:function(){return this.numberOfExamples}},{key:"getExampleSize",value:function(){return this.exampleSize}},{key:"getBatch",value:function(e,r){var n=this.data.block(0,e,this.data.rows,r);return t.fromMatrix(n)}}])&&on(e.prototype,r),n&&on(e,n),t}();function cn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var sn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"fromSource",value:function(t){return new Promise((function(e){t.then((function(t){var r=t.parse(),n=r.cols,o=r.rows,i=new un(o,n,r.data);e(i)}))}))}}],null&&cn(e.prototype,null),r&&cn(e,r),t}();function fn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var hn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),yn(this,"vocabularySize",0),yn(this,"dataSize",0),yn(this,"data",""),this.data=e.toLowerCase();var r,n=function(t){if(Array.isArray(t))return fn(t)}(r=new Set(this.data.split("").sort()))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return fn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fn(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();this.chars=n,this.dataSize=this.data.length,this.vocabularySize=n.length}var e,r;return e=t,r=[{key:"getExamples",value:function(){return this.data.replace(/\n+/,"\n").split("\n").map((function(t){return t+"\n"}))}},{key:"getVocabularySize",value:function(){return this.vocabularySize}},{key:"getCharsLength",value:function(){return this.chars.length}},{key:"getCharIndices",value:function(){var t={};return this.chars.forEach((function(e,r){t[e]=r})),t}},{key:"buildData",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=[],n=[],o=0;o<this.data.length-t;o+=e)r.push(this.data.substr(o,t)),n.push(this.data[o+t]);return[r,n]}},{key:"vectorization",value:function(t,e){var r=this,n=t.length,o=new Array(n),i=this.getCharIndices(),a=new pt(n,this.chars.length).setZeros();return t.forEach((function(t,n){o[n]=new pt(t.length,r.chars.length).setZeros(),t.split("").forEach((function(t,e){o[n].data[e][i[t]]=1})),a.data[n][i[e[n]]]=1})),[o,a]}},{key:"getChars",value:function(){return this.chars}},{key:"getExampleX",value:function(t){var e=this,r=this.getExamples()[t],n=[],o=this.getCharIndices();return r.split("").forEach((function(t,r){n[r]=[];for(var i=0;i<e.vocabularySize;i+=1)n[r][i]=0;n[r][o[t]]=1})),pt.from(n).transpose()}},{key:"getExampleY",value:function(t){var e=this,r=this.getExamples()[t],n=[],o=this.getCharIndices();return r.split("").forEach((function(t,r){n[r]=[];for(var i=0;i<e.vocabularySize;i+=1)n[r][i]=0;n[r][o[t]]=1})),pt.from(n).transpose()}}],r&&ln(e.prototype,r),t}();function pn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var bn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"fromSource",value:function(t){return new Promise((function(e){t.then((function(t){var r=t.parse();e(new hn(r))}))}))}}],null&&pn(e.prototype,null),r&&pn(e,r),t}();function dn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var wn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),vn(this,"batchSize",0),vn(this,"t",0),vn(this,"learningRate",0)}var e,r;return e=t,(r=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}}])&&dn(e.prototype,r),t}();function mn(t){return mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mn(t)}function gn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function On(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sn(t,e){return Sn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Sn(t,e)}function kn(t,e){if(e&&("object"===mn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return jn(t)}function jn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pn(t){return Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Pn(t)}function _n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var xn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sn(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pn(n);if(o){var r=Pn(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return kn(this,t)});function a(){var t;gn(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return _n(jn(t=i.call.apply(i,[this].concat(r))),"beta1",.9),_n(jn(t),"beta2",.999),t}return e=a,(r=[{key:"setBeta1",value:function(t){return this.beta1=t,this}},{key:"setBeta2",value:function(t){return this.beta2=t,this}},{key:"optimize",value:function(t){this.adam(t,this.learningRate,this.t)}},{key:"adam",value:function(t,e,r){t.vW=t.vW.multiply(this.beta1).add(t.gW.multiply(1-this.beta1)),t.vb=t.vb.multiply(this.beta1).add(t.gb.multiply(1-this.beta1)),t.sW=t.sW.multiply(this.beta2).add(t.gW.pow(2).multiply(1-this.beta2)),t.sb=t.sb.multiply(this.beta2).add(t.gb.pow(2).multiply(1-this.beta2));var n=t.vW.divide(1-Math.pow(this.beta1,2)),o=t.vb.divide(1-Math.pow(this.beta1,2)),i=t.sW.divide(1-Math.pow(this.beta2,2)),a=t.sb.divide(1-Math.pow(this.beta2,2));t.W=t.W.subtract(n.multiply(e).divide(i.sqrt().add(1e-8))),t.b=t.b.subtract(o.multiply(e).divide(a.sqrt().add(1e-8)))}}])&&On(e.prototype,r),a}(wn);function Rn(t){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rn(t)}function En(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tn(t,e){return Tn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Tn(t,e)}function zn(t,e){if(e&&("object"===Rn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Cn(t){return Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Cn(t)}var Dn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tn(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Cn(n);if(o){var r=Cn(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return zn(this,t)});function a(){return En(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"optimize",value:function(t){this.gradientDescent(t,this.learningRate)}},{key:"gradientDescent",value:function(t,e){t.W=t.W.subtract(t.gW.multiply(e)),t.b=t.b.subtract(t.b.multiply(e))}}])&&Wn(e.prototype,r),a}(wn);function Mn(t){return Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mn(t)}function Bn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function An(t,e){return An=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},An(t,e)}function Kn(t,e){if(e&&("object"===Mn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Nn(t){return Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Nn(t)}var Zn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&An(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Nn(n);if(o){var r=Nn(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Kn(this,t)});function a(){return Bn(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"optimize",value:function(t){this.adagrad(t,this.learningRate)}},{key:"adagrad",value:function(t,e){t.dW=t.dW.add(t.gW.pow(2)),t.W=t.W.subtract(t.gW.multiply(e).divide(t.dW.sqrt().add(1e-8)).multiply(t.gW)),t.db=t.db.add(t.gb.pow(2)),t.b=t.b.subtract(t.db.multiply(e).divide(t.db.sqrt().add(1e-8)).multiply(t.gb))}}])&&Ln(e.prototype,r),a}(wn);function Fn(t){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fn(t)}function Hn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function In(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qn(t,e){return qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},qn(t,e)}function Vn(t,e){if(e&&("object"===Fn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Un(t)}function Un(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qn(t){return Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Qn(t)}function Xn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Yn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qn(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qn(n);if(o){var r=Qn(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Vn(this,t)});function a(){var t;Hn(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Xn(Un(t=i.call.apply(i,[this].concat(r))),"beta",.9),t}return e=a,(r=[{key:"optimize",value:function(t){this.momentum(t,this.learningRate)}},{key:"setBeta",value:function(t){return this.beta=t,this}},{key:"momentum",value:function(t,e){t.vW=t.gW.multiply(this.beta).add(t.gW.multiply(1-this.beta)),t.vb=t.gb.multiply(this.beta).add(t.gb.multiply(1-this.beta)),t.W=t.W.subtract(t.vW.multiply(e)),t.b=t.b.subtract(t.vb.multiply(e))}}])&&In(e.prototype,r),a}(wn);function Jn(t){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jn(t)}function Gn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function to(t,e){return to=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},to(t,e)}function eo(t,e){if(e&&("object"===Jn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ro(t)}function ro(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function no(t){return no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},no(t)}function oo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var io=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&to(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=no(n);if(o){var r=no(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return eo(this,t)});function a(){var t;Gn(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return oo(ro(t=i.call.apply(i,[this].concat(r))),"alpha",.001),oo(ro(t),"beta",.9),t}return e=a,(r=[{key:"setBeta",value:function(t){return this.beta=t,this}},{key:"setAlpha",value:function(t){return this.alpha=t,this}},{key:"optimize",value:function(t){this.rmsprop(t,this.learningRate,this.alpha,this.beta)}},{key:"rmsprop",value:function(t,e,r,n){t.sW=t.sW.multiply(n).add(t.gW.pow(2).multiply(1-n)),t.sb=t.sb.multiply(n).add(t.gb.pow(2).multiply(1-n)),t.W=t.W.subtract(t.gW.multiply(r).divide(t.sW.sqrt().add(1e-8))),t.b=t.b.subtract(t.gb.multiply(r).divide(t.sb.sqrt().add(1e-8)))}}])&&$n(e.prototype,r),a}(wn);function ao(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function uo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var co=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),uo(this,"network",null),uo(this,"optimizer",null),uo(this,"regularization",1e-4),uo(this,"iterations",1e3),uo(this,"learningRate",.001),uo(this,"verbose",!0),uo(this,"verboseStep",1),uo(this,"stepCallback",(function(t){})),this.network=e,this.optimizer=r}var e,r;return e=t,r=[{key:"setRegularization",value:function(t){return this.regularization=t,this}},{key:"setIterations",value:function(t){return this.iterations=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}},{key:"setVerbose",value:function(t){return this.verbose=t,this}},{key:"setVerboseStep",value:function(t){return this.verboseStep=t,this}},{key:"setStepCallback",value:function(t){return this.stepCallback=t,this}},{key:"cost",value:function(t,e){var r=t.getNumberOfExamples(),n=0,o=0;this.network.getLayers().forEach((function(t){o+=t.penalty()}));for(var i=this.network.forward(t.data),a=e.data,u=-1/r*a.multiply(i.log()).sum()+this.regularization/(o*(2*t.data.cols)),c=0;c<i.cols;c+=1)i.colMaxCoeffIndex(c)===a.colMaxCoeffIndex(c)&&n++;return{cost:u,accuracy:n/r*100}}}],r&&ao(e.prototype,r),t}();function so(t){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},so(t)}function fo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yo(t,e){return yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yo(t,e)}function ho(t,e){if(e&&("object"===so(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return po(t)}function po(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bo(t){return bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bo(t)}function vo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var wo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yo(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=bo(n);if(o){var r=bo(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ho(this,t)});function a(){var t;fo(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return vo(po(t=i.call.apply(i,[this].concat(r))),"batchSize",100),t}return e=a,r=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"cost",value:function(t,e){var r=this.batchSize,n=t.getNumberOfExamples(),o=(Math.ceil(n/r),0),i=0,a=0;this.network.getLayers().forEach((function(t){a=t.penalty()})),(new Date).getTime(),(new Date).getTime();for(var u=0,c=0;u<n;u+=this.batchSize,c+=this.batchSize){(new Date).getTime();var s=t.getBatch(c,this.batchSize),f=e.getBatch(c,this.batchSize),l=this.network.forward(s.data);o+=-1/n*f.data.multiply(l.log()).sum()+this.regularization/(a*(2*t.data.cols));for(var y=0;y<l.cols;y+=1)l.colMaxCoeffIndex(y)===f.data.colMaxCoeffIndex(y)&&i++}return{cost:o,accuracy:i/n*100}}},{key:"train",value:function(t,e){var r=this,n=t.getNumberOfExamples(),o=0;this.optimizer.setBatchSize(this.batchSize),this.optimizer.setLearningRate(this.learningRate);for(var i=0;i<this.iterations;i+=1){for(var a=(new Date).getTime(),u=(new Date).getTime(),c=0,s=0;c<n;c+=this.batchSize,s+=this.batchSize){var f=(new Date).getTime(),l=t.getBatch(s,this.batchSize),y=e.getBatch(s,this.batchSize),h=this.network.forward(l.data);if(this.network.backward(l.data,y.data,h,this.regularization),this.optimizer.setT(++o),this.network.getLayers().forEach((function(t){r.optimizer.optimize(t)})),this.verbose){var p=this.cost(l,y),b=(new Date).getTime();console.log("Batch: ".concat(s," / ").concat(n," | Batch time: ").concat(b-f,"ms | Time from start: ").concat(er((b-u)/1e3,1),"s. | Cost: ").concat(er(p.cost,2)," | Acc: ").concat(p.accuracy))}}if(this.verbose&&(i+1)%this.verboseStep==0){var d=(new Date).getTime(),v=this.cost(t,e);console.log("Iteration: ".concat(i+1," | Cost: ").concat(er(v.cost,5)," | Accuracy: ").concat(v.accuracy,"% | Time: ").concat((d-a)/1e3," s."))}this.stepCallback({iteration:i})}return this}}],r&&lo(e.prototype,r),a}(co);function mo(t){return mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mo(t)}function go(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function So(t,e){return So=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},So(t,e)}function ko(t,e){if(e&&("object"===mo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function jo(t){return jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},jo(t)}var Po=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&So(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=jo(n);if(o){var r=jo(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ko(this,t)});function a(){return go(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"train",value:function(t,e){var r=this,n=t.getNumberOfExamples(),o=0;this.optimizer.setBatchSize(n),this.optimizer.setLearningRate(this.learningRate);for(var i=0;i<this.iterations;i+=1){var a=(new Date).getTime(),u=this.network.forward(t.data);if(this.network.backward(t.data,e.data,u,this.regularization),this.optimizer.setT(++o),this.network.getLayers().forEach((function(t){r.optimizer.optimize(t)})),this.verbose&&(i+1)%this.verboseStep==0){var c=this.cost(t,e),s=(new Date).getTime();console.log("Iteration: ".concat(i+1," | Cost: ").concat(er(c.cost,5)," | Accuracy: ").concat(er(c.accuracy,2),"% | Time: ").concat((s-a)/1e3," s."))}this.stepCallback({iteration:i})}return this}}])&&Oo(e.prototype,r),a}(co);function _o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return xo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xo(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ro(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Eo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Wo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Eo(this,"network",null),Eo(this,"iterations",1e3),Eo(this,"learningRate",.001),this.network=e}var e,r;return e=t,(r=[{key:"train",value:function(t){for(var e=this.network.loss(t.getVocabularySize(),7),r=t.getExamples(),n=(t.getCharIndices(),new pt(100,1).setRandom(1).abs().setMax(t.getVocabularySize()).setMin(0)),o=0;o<this.iterations;o+=1){console.log("Iteration ".concat(o+1));var i=o%r.length,a=t.getExampleX(i),u=t.getExampleY(i);e=_o(this.network.forward(a,u,n),1)[0],this.network.backward(a,u);var c=_o(this.network.optimize(a,u,n,this.learningRate),2),s=c[0];n=c[1],e=.999*e+.001*s,console.log("Iteration ".concat(o+1," | Loss: ").concat(e," | Sample: ").concat(this.network.sample(t).trim()))}return[e]}},{key:"setIterations",value:function(t){return this.iterations=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}}])&&Ro(e.prototype,r),t}(),To=function t(e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(r="dataset")in this?Object.defineProperty(this,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[r]=null,this.dataset=e};function zo(t){return zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zo(t)}function Co(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Do(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mo(t,e){return Mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Mo(t,e)}function Bo(t,e){if(e&&("object"===zo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Lo(t)}function Lo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ao(t){return Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ao(t)}function Ko(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var No=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mo(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ao(n);if(o){var r=Ao(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Bo(this,t)});function a(){var t;Co(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Ko(Lo(t=i.call.apply(i,[this].concat(r))),"callback",(function(t){return t})),t}return e=a,(r=[{key:"apply",value:function(){for(var t=0;t<this.dataset.getNumberOfExamples();t+=1)for(var e=this.callback(this.dataset.exampleAt(t)),r=0;r<this.dataset.data.rows;r+=1)e&&(this.dataset.data.data[r][t]=e.data[r][0]);return this.dataset}},{key:"setCallback",value:function(t){return this.callback=t,this}}])&&Do(e.prototype,r),a}(To);function Zo(t){return Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zo(t)}function Fo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ho(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Io(t,e){return Io=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Io(t,e)}function qo(t,e){if(e&&("object"===Zo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vo(t){return Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Vo(t)}var Uo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Io(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Vo(n);if(o){var r=Vo(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return qo(this,t)});function a(){return Fo(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"apply",value:function(t){for(var e=1/0,r=-1/0,n=0;n<t.getNumberOfExamples();n+=1)for(var o=t.exampleAt(n),i=0;i<o.rows;i+=1)e>o.data[i][0]&&(e=o.data[i][0]),r<o.data[i][0]&&(r=o.data[i][0]);for(var a=0;a<t.getNumberOfExamples();a+=1)for(var u=t.exampleAt(a),c=0;c<u.rows;c+=1)t.data.data[c][a]=(u.data[c][0]-e)/(r-e);return t}}])&&Ho(e.prototype,r),a}(To);function Qo(t){return Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qo(t)}function Xo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jo(t,e){return Jo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Jo(t,e)}function Go(t,e){if(e&&("object"===Qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $o(t)}function $o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ti(t){return ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ti(t)}function ei(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ri=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jo(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ti(n);if(o){var r=ti(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Go(this,t)});function a(){var t;Xo(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ei($o(t=i.call.apply(i,[this].concat(r))),"modificationType","mean"),t}return e=a,(r=[{key:"apply",value:function(t){for(var e=[],r=0,n=0,o=0,i=0;i<t.getNumberOfExamples();i+=1)for(var a=t.exampleAt(i),u=0;u<t.getExampleSize();u+=1)isNaN(a.data[u][0])||void 0===a.data[u][0]?e.push({row:u,col:a}):(n+=a.data[u][0],r++);return"mean"===this.modificationType&&(o=n/r),e.forEach((function(e){var r=e.row,n=e.col;t.data.data[r][n]=o})),t}},{key:"setModificationType",value:function(t){return this.modificationType=t,this}}])&&Yo(e.prototype,r),a}(To);function ni(t){return ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ni(t)}function oi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ii(t,e){return ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ii(t,e)}function ai(t,e){if(e&&("object"===ni(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ui(t)}function ui(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ci(t){return ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ci(t)}var si=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ii(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ci(n);if(o){var r=ci(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ai(this,t)});function a(t){var e,r,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o=[],(n="sortList")in(r=ui(e=i.call(this,t)))?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,e}return e=a,(r=[{key:"apply",value:function(t){var e=this,r=0,n=pt.from(t.data.transpose().data.sort((function(t,n){return void 0===e.sortList[r]&&(e.sortList[r]=Math.random()-.5),r+=1,e.sortList[r-1]}))).transpose().data;return new un(t.getExampleSize(),t.getNumberOfExamples(),n)}}])&&oi(e.prototype,r),a}(To),fi=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};const li=require("csvtojson");function yi(t){return yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yi(t)}function hi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pi(t,e){return pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pi(t,e)}function bi(t,e){if(e&&("object"===yi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return di(t)}function di(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vi(t){return vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},vi(t)}function wi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mi;!function(t){t[t.UnquotedField=0]="UnquotedField",t[t.QuotedField=1]="QuotedField",t[t.QuotedQuote=2]="QuotedQuote"}(mi||(mi={}));var gi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pi(t,e)}(u,t);var e,r,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=vi(o);if(i){var r=vi(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return bi(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),wi(di(e=a.call(this)),"data",null),wi(di(e),"matrixData",null),e.data=t,e}return e=u,n=[{key:"fromLocalFile",value:function(t){return new Promise((function(e){li({noheader:!0,output:"csv"}).fromFile(t).then((function(t){e(new u(t))}))}))}}],(r=[{key:"parse",value:function(){var t=this.data.length,e=this.data[0].length;return new pt(t,e,this.data).transpose()}}])&&hi(e.prototype,r),n&&hi(e,n),u}(fi);function Oi(t){return Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oi(t)}function Si(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ki(t,e){return ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ki(t,e)}function ji(t,e){if(e&&("object"===Oi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Pi(t)}function Pi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _i(t){return _i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_i(t)}var xi={NetworkBuilder1D:Xr,NetworkBuilder3D:rn},Ri={Matrix:pt},Ei={SoftmaxLayer:je,LogisticLayer:Te,ReluLayer:qe,SoftplusLayer:Ge,TanhLayer:Ae,ConvLayer:vr,MaxPoolLayer:Cr,FullyConnectedLayer:jr,RNNLayer:Fr},Wi={DatasetBuilder:sn,DatasetVocabularyBuilder:bn},Ti={OptimizerAdam:xn,OptimizerGradientDescent:Dn,OptimizerAdagrad:Zn,OptimizerMomentum:Yn,OptimizerRMSProp:io},zi={MiniBatchTrainer:wo,Trainer:Po,RNNTrainer:Wo},Ci={CallbackDatasetModifier:No,MinMaxScalingDatasetModifier:Uo,MissingDataScalingDatasetModifier:ri,ShuffleDatasetModifier:si},Di={ComputationCPU:ct,ComputationGPU:C,setComputation:function(t){st=t},getComputation:ft},Mi={Dataset:un},Bi={DatasetBuilderSourceCSV:gi,DatasetVocabularyBuilderSourceTextFile:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ki(t,e)}(c,(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}));var e,n,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_i(i);if(a){var r=_i(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ji(this,t)});function c(t){var e,r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),"",(n="data")in(r=Pi(e=u.call(this)))?Object.defineProperty(r,n,{value:"",enumerable:!0,configurable:!0,writable:!0}):r.data="",e.data=t,e}return e=c,o=[{key:"fromLocalFile",value:function(t){return new Promise((function(e,n){r.readFile(t,(function(t,r){t?n(t):e(new c(r.toString("utf-8")))}))}))}}],(n=[{key:"parse",value:function(){return this.data}}])&&Si(e.prototype,n),o&&Si(e,o),c}()},Li={NetworkRNN:Ot};module.exports=e})();
//# sourceMappingURL=impulse-ts.js.map