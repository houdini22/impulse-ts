(()=>{"use strict";var t={74:(t,e,r)=>{function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.d(e,{C:()=>o});var o=function(){function t(){var e,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r={},(e="kernels")in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r}var e,r;return e=t,r=[{key:"addKernel",value:function(t,e){return this.kernels[t]=e,this}},{key:"execute",value:function(t){if(!this.kernels[t])throw new Error("Kernel '".concat(t,"' not exists."));for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return this.kernels[t].apply(null,r)}}],r&&n(e.prototype,r),t}()},589:(t,e,r)=>{r.d(e,{CU:()=>B});var n=r(74),o=r(841);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var s=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)r[n][i]=t.data[n][i]/e.data[n][i]}return new o.y(t.rows,e.cols,r)},f=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)r[n][i]=t.data[n][i]/e}return new o.y(t.rows,t.cols,r)},l=function(t){for(var e=[],r=t.max(),n=0;n<t.rows;n+=1){e[n]=[];for(var i=0;i<t.cols;i+=1)e[n][i]=Math.exp(t.data[n][i]-r)}var u=new o.y(t.rows,t.cols,e),a=new o.y(1,t.cols,u.colwiseSum().data).replicate(t.rows,1);return new o.y(t.rows,t.cols,s(u,a).data)},y=function(t,e){for(var r=[],n=0;n<e.rows;n+=1){r[n]=[];for(var i=0;i<e.cols;i+=1)r[n][i]=t.data[n][i]*Math.log(e.data[n][i]+1e-8)}return new o.y(t.rows,t.cols,r).sum()},p=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=1/(1+Math.exp(-t.data[r][n]))}return new o.y(t.rows,t.cols,e)},h=function(t,e){for(var r=[],n=0;n<e.rows;n+=1){r[n]=[];for(var i=0;i<e.cols;i+=1)e.data&&(r[n][i]=Math.log(e.data[n][i]+1e-8))}for(var u=R(new o.y(e.rows,e.cols,r),t),a=[],c=0;c<t.rows;c+=1){a[c]=[];for(var s=0;s<t.cols;s+=1)t.data&&(a[c][s]=1-t.data[c][s])}for(var f=new o.y(t.rows,t.cols,a),l=[],y=0;y<e.rows;y+=1){l[y]=[];for(var p=0;p<e.cols;p+=1)e.data&&(l[y][p]=Math.log(1-e.data[y][p]+1e-8))}var h=new o.y(e.rows,e.cols,l);return j(R(K(u,-1),t),R(K(h,-1),E(f,1))).sum()},b=function(t,e){return new o.y(e.rows,e.cols,R(e,E(e,1)).data)},d=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=2/(1+Math.exp(-2*t.data[r][n]))-1)}return new o.y(t.rows,t.cols,e)},v=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.max(0,t.data[r][n]))}return new o.y(t.rows,t.cols,e)},w=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&(r[n][i]=e.data[n][i]>0?1:0)}return R(new o.y(t.rows,t.cols,r),t)},m=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.log(1+Math.exp(t.data[r][n])))}return new o.y(t.rows,t.cols,e)},g=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.pow(t.data[r][n],2))}return new o.y(t.rows,t.cols,e).sum()},O=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)t.data&&(e[r][n]=Math.sqrt(t.data[r][n]+1e-8))}return new o.y(t.rows,t.cols,e)},S=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&(r[n][i]=t.data[n][i]-Math.pow(e[n][i],2))}return new o.y(t.rows,t.cols,r).sum()},x=function(t,e){if(t.cols!==e.rows)throw new Error("DIMENSIONS error. m1.cols ".concat(t.rows," ").concat(t.cols," !== m2.rows ").concat(e.rows," ").concat(e.cols,"."));for(var r=[],n=0;n<t.rows;++n){r[n]=new Array(e.cols);for(var i=0;i<e.cols;++i){r[n][i]=0;for(var u=0;u<t.cols;++u)t.data&&e.data&&(r[n][i]+=t.data[n][u]*e.data[u][i])}}return new o.y(t.rows,e.cols,r)},j=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal. m1.cols ".concat(t.cols," !== m2.cols ").concat(e.cols));for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&e.data&&(r[n][i]=t.data[n][i]+e.data[n][i])}return new o.y(t.rows,t.cols,r)},k=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal: m1.rows ".concat(t.rows," !== m2.rows ").concat(e.rows));if(t.cols!==e.cols)throw new Error("COLS number not equal: m1.cols ".concat(t.cols," !== m2.cols ").concat(e.cols));for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&e.data&&(r[n][i]=t.data[n][i]-e.data[n][i])}return new o.y(t.rows,t.cols,r)},P=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)r[n][i]=(4*Math.random()-2)*Math.sqrt(2/e)}return new o.y(t.rows,t.cols,r)},_=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=0}return new o.y(t.rows,t.cols,e)},R=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal: m1.rows ".concat(t.rows," !== m2.rows ").concat(e.rows));if(t.cols!==e.cols)throw new Error("COLS number not equal: m1.cols ".concat(t.cols," !== m2.cols ").concat(e.cols));for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&e.data&&(r[n][i]=t.data[n][i]*e.data[n][i])}return new o.y(t.rows,t.cols,r)},K=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&(r[n][i]=t.data[n][i]*e)}return new o.y(t.rows,t.cols,r)},E=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&(r[n][i]=e-t.data[n][i])}return new o.y(t.rows,t.cols,r)},W=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&(r[n][i]=Math.pow(t.data[n][i],e))}return new o.y(t.rows,t.cols,r)},T=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&(r[n][i]=Math.log(t.data[n][i]+1e-8))}return new o.y(t.rows,t.cols,r)},z=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)t.data&&(r[n][i]=Math.log(1-t.data[n][i]))}return new o.y(t.rows,t.cols,r)},D=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var i=0;i<t.cols;i+=1)r[n][i]=t.data[n][i]+e}return new o.y(t.rows,t.cols,r)},C=function(t){for(var e=[],r=0;r<t.cols;r+=1){e[r]=[];for(var n=0;n<t.rows;n+=1)t.data&&(e[r][n]=t.data[n][r])}return new o.y(t.cols,t.rows,e)},B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=c(e);if(r){var o=c(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return a(this,t)});function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this)).addKernel("multiply",x),t.addKernel("add",j),t.addKernel("subtract",k),t.addKernel("subtractFromNumber",E),t.addKernel("fillRandom",P),t.addKernel("fillZeros",_),t.addKernel("elementWiseMultiply",R),t.addKernel("multiplyNumber",K),t.addKernel("elementWiseDivide",s),t.addKernel("divideNumber",f),t.addKernel("softmaxActivation",l),t.addKernel("softmaxLoss",y),t.addKernel("logisticActivation",p),t.addKernel("logisticLoss",h),t.addKernel("logisticBackpropagation",b),t.addKernel("tanhActivation",d),t.addKernel("reluActivation",v),t.addKernel("reluBackpropagation",w),t.addKernel("softplusActivation",m),t.addKernel("penalty",g),t.addKernel("sqrt",O),t.addKernel("purelinLoss",S),t.addKernel("transpose",C),t.addKernel("pow",W),t.addKernel("log",T),t.addKernel("logMinusOne",z),t.addKernel("addNumber",D),t}return o}(n.C)},814:(t,e,r)=>{r.d(e,{CU:()=>W.CU,d_:()=>E,K0:()=>T.K,fR:()=>T.f});var n=r(74),o=r(841);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var s=new(require("gpu.js").GPU)({mode:"gpu"}),f=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=s.createKernel((function(t,e){return t[this.thread.x][this.thread.y]/e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new o.y(t.rows,t.cols,r(t.data,e.data))},l=function(t,e){var r=s.createKernel((function(t){return t[this.thread.x][this.thread.y]/this.constants.number})).setOutput([t.rows,t.cols]).setConstants({number:e});return new o.y(t.rows,t.cols,r(t.data))},y=function(t){var e=s.createKernel((function(t){return Math.exp(t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]),r=new o.y(t.rows,t.cols,e(t.data)),n=new o.y(1,t.cols,r.colwiseSum().data).replicate(t.rows,1);return new o.y(t.rows,t.cols,f(r,n).data)},p=function(t,e){var r=s.createKernel((function(t){return Math.log(t[this.thread.x][this.thread.y])})).setOutput([e.rows,e.cols]);return new o.y(t.rows,t.cols,_(t,new o.y(t.rows,t.cols,r(e.data))).data).sum()},h=function(t){var e=s.createKernel((function(t){return 1/(1+Math.exp(-t[this.thread.x][this.thread.y]))})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,e(t.data))},b=function(t,e){var r=s.createKernel((function(t){return Math.log(t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]),n=s.createKernel((function(t){return 1-t[this.thread.x][this.thread.y]})).setOutput([t.rows,t.cols]),i=s.createKernel((function(t){return Math.log(1-t[this.thread.x][this.thread.y])})).setOutput([e.rows,e.cols]);return x(_(t,new o.y(t.rows,t.cols,r(t.data))),_(new o.y(t.rows,t.cols,n(t.data)),new o.y(e.rows,e.cols,i(e.data)))).sum()},d=function(t){var e=s.createKernel((function(t){return 2/(1+Math.exp(-2*t[this.thread.x][this.thread.y]))-1})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,e(t.data))},v=function(t){var e=s.createKernel((function(t){return Math.max(0,t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,e(t.data))},w=function(t){var e=s.createKernel((function(t){return Math.log(1+Math.exp(t[this.thread.x][this.thread.y]))})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,e(t.data))},m=function(t){var e=s.createKernel((function(t){return Math.pow(t[this.thread.x][this.thread.y],2)})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,e(t.data)).sum()},g=function(t){var e=s.createKernel((function(t){return Math.sqrt(t[this.thread.x][this.thread.y]+1e-8)})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,e(t.data))},O=function(t,e){var r=s.createKernel((function(t,e){return e[this.thread.x][this.thread.y]-Math.pow(t[this.thread.x][this.thread.y],2)})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,r(t.data)).sum()},S=function(t,e){if(t.cols!==e.rows)throw new Error("DIMENSIONS error. m1.cols ".concat(t.cols," !== m2.rows ").concat(e.rows,"."));var r=s.createKernel((function(t,e){for(var r=0,n=0;n<this.constants.cols;n++)r+=t[this.thread.x][n]*e[n][this.thread.y];return r})).setOutput([t.rows,e.cols]).setConstants({cols:t.rows});return new o.y(t.rows,e.cols,r(t.data,e.data))},x=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=s.createKernel((function(t,e){return t[this.thread.x][this.thread.y]+e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new o.y(t.rows,e.cols,r(t.data,e.data))},j=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=s.createKernel((function(t,e){return t[this.thread.x][this.thread.y]-e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new o.y(t.rows,e.cols,r(t.data,e.data))},k=function(t,e){var r=s.createKernel((function(){return Math.random()-.5})).setOutput([t.rows,t.cols]).setConstants({parameter:e});return new o.y(t.rows,t.cols,r())},P=function(t){var e=s.createKernel((function(){return 0})).setOutput([t.rows,t.cols]);return new o.y(t.rows,t.cols,e())},_=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=s.createKernel((function(t,e){return t[this.thread.x][this.thread.y]*e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new o.y(t.rows,e.cols,r(t.data,e.data))},R=function(t,e){var r=s.createKernel((function(t){return t[this.thread.x][this.thread.y]*this.constants.number})).setOutput([t.rows,t.cols]).setConstants({number:e});return new o.y(t.rows,t.cols,r(t.data))},K=function(t){var e=s.createKernel((function(t){return t[this.thread.y][this.thread.x]})).setOutput([t.cols,t.rows]);return new o.y(t.cols,t.rows,e(t.data))},E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=c(e);if(r){var o=c(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return a(this,t)});function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this)).addKernel("multiply",S),t.addKernel("add",x),t.addKernel("subtract",j),t.addKernel("fillRandom",k),t.addKernel("fillZeros",P),t.addKernel("elementWiseMultiply",_),t.addKernel("multiplyNumber",R),t.addKernel("elementWiseDivide",f),t.addKernel("divideNumber",l),t.addKernel("softmaxActivation",y),t.addKernel("softmaxLoss",p),t.addKernel("logisticActivation",h),t.addKernel("logisticLoss",b),t.addKernel("tanhActivation",d),t.addKernel("reluActivation",v),t.addKernel("softplusActivation",w),t.addKernel("penalty",m),t.addKernel("sqrt",g),t.addKernel("purelinLoss",O),t.addKernel("transpose",K),t}return o}(n.C),W=r(589),T=r(798)},798:(t,e,r)=>{r.d(e,{f:()=>o,K:()=>i});var n=new(r(589).CU),o=function(t){n=t},i=function(){return n}},841:(t,e,r)=>{r.d(e,{y:()=>a});var n=r(798);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,t),u(this,"rows",0),u(this,"cols",0),u(this,"data",null),this.resize(e,r),n&&this.generateData(n)}var e,r;return e=t,(r=[{key:"resize",value:function(t,e){this.rows=t,this.cols=e,this.data=[];for(var r=0;r<this.rows;r+=1)this.data[r]=new Array(this.cols);return this}},{key:"generateData",value:function(t){for(var e=[],r=0;r<this.rows;r+=1)e[r]=new Array(this.cols);for(var n=0;n<this.cols;n+=1)for(var o=0;o<this.rows;o+=1)"number"==typeof t[o]?e[o][n]=t[o]:t[o]instanceof Float32Array||t[o]&&"number"==typeof t[o][n]?e[o][n]=t[o][n]:"string"==typeof t[o][n]?e[o][n]=t[o][n].length?Number(t[o][n]):NaN:e[o][n]=NaN;return this.data=e,this}},{key:"sum",value:function(){for(var t=0,e=0;e<this.rows;e+=1)for(var r=0;r<this.cols;r+=1)t+=this.data[e][r];return t}},{key:"colwiseSum",value:function(){for(var e=[],r=this.transpose(),n=0;n<r.rows;n+=1){e[n]=[0];for(var o=0;o<r.cols;o+=1)e[n][0]+=r.data[n][o]}return new t(this.cols,1,e)}},{key:"rowwiseSum",value:function(){for(var e=[[]],r=0;r<this.rows;r+=1){for(var n=0,o=0;o<this.cols;o+=1)n+=this.data[r][o];e[0].push(n)}return new t(1,this.rows,e)}},{key:"replicate",value:function(e,r){var n=this.data,o=[],i=null;if(1===e&&1===this.cols&&r>1){i=new t(this.rows,r);for(var u=0;u<this.rows;u+=1){o[u]=[];for(var a=0;a<r;a+=1)o[u][a]=n[u][0]}}else if(1===r&&1===this.rows&&e>1){i=new t(e,this.cols);for(var c=0;c<e;c+=1){o[c]=[];for(var s=0;s<this.cols;s+=1)o[c][s]=n[0][s]}}return i?(i.generateData(o),i):this}},{key:"transpose",value:function(){return(0,n.K)().execute("transpose",this)}},{key:"colMaxCoeffIndex",value:function(t){for(var e=-1,r=-1/0,n=0;n<this.rows;n+=1)this.data&&this.data[n][t]>r&&(r=this.data[n][t],e=n);return e}},{key:"block",value:function(e,r,n,o){for(var i=[],u=e,a=0;u<this.rows&&u<e+n;u+=1,a+=1){i[a]=new Array(o);for(var c=r,s=0;c<this.cols&&c<r+o;c+=1,s+=1)i[a][s]=this.data[u][c]}return new t(n,o,i)}},{key:"col",value:function(e){for(var r=[],n=0;n<this.rows;n+=1)r[n]=[this.data[n][e]];return new t(this.rows,1,r)}},{key:"setCol",value:function(t,e){for(var r=0;r<this.rows;r+=1)this.data&&e.data&&(this.data[r][t]=e.data[r][0]);return this}},{key:"rollToColMatrix",value:function(){for(var e=[],r=0,n=0;n<this.rows;n+=1){e[n]=[];for(var o=0;o<this.cols;o+=1)this.data&&(e[r++][0]=this.data[n][o])}return new t(this.rows*this.cols,1,e)}},{key:"mean",value:function(){for(var t=0,e=this.rows*this.cols,r=0;r<this.rows;r+=1)for(var n=0;n<this.cols;n+=1)t+=this.data[r][n];return t/e}},{key:"max",value:function(){for(var t=-1/0,e=0;e<this.rows;e+=1)for(var r=0;r<this.cols;r+=1)t=Math.max(this.data[e][r],t);return t}}])&&i(e.prototype,r),t}()},35:(t,e,r)=>{r.d(e,{J:()=>u});var n=r(814);function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}t=r.hmd(t);var u=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"network",null),i(this,"optimizer",null),i(this,"regularization",1e-8),i(this,"iterations",1e3),i(this,"learningRate",.01),i(this,"verbose",!0),i(this,"verboseStep",1),i(this,"stepCallback",(function(t){})),this.network=e,this.optimizer=r}var e,r;return e=t,(r=[{key:"setRegularization",value:function(t){return this.regularization=t,this}},{key:"setIterations",value:function(t){return this.iterations=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}},{key:"setVerbose",value:function(t){return this.verbose=t,this}},{key:"setVerboseStep",value:function(t){return this.verboseStep=t,this}},{key:"setStepCallback",value:function(t){return this.stepCallback=t,this}},{key:"cost",value:function(t,e){var r=t.getNumberOfExamples(),o=0,i=0;this.network.getLayers().forEach((function(t){i+=t.penalty()}));for(var u=this.network.forward(t.data),a=e.data,c=-1/r*(0,n.K0)().execute("add",(0,n.K0)().execute("multiply",a,(0,n.K0)().execute("log",u).transpose()),(0,n.K0)().execute("multiply",(0,n.K0)().execute("subtractFromNumber",a,1),(0,n.K0)().execute("logMinusOne",u).transpose())).sum()+this.regularization/(i/2*t.getNumberOfExamples()),s=0;s<u.cols;s+=1)u.colMaxCoeffIndex(s)===a.colMaxCoeffIndex(s)&&o++;return{cost:c,accuracy:(o-1)/r*100}}}])&&o(e.prototype,r),t}()}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n](i,i.exports,r),i.loaded=!0,i.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{r.r(n),r.d(n,{Computation:()=>Pn,Dataset:()=>_n,DatasetBuilder:()=>Sn,DatasetBuilderSource:()=>Rn,DatasetModifier:()=>kn,Layer:()=>On,Math:()=>gn,NetworkBuilder:()=>mn,Optimizer:()=>xn,Trainer:()=>jn});const t=require("fs");var e=r(814);function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u,a=function(){function r(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),i(this,"dimensions",null),i(this,"size",0),i(this,"layers",[]),this.dimensions=t}var n,u;return n=r,(u=[{key:"addLayer",value:function(t){return this.size++,this.layers.push(t),this}},{key:"getLayers",value:function(){return this.layers}},{key:"forward",value:function(t){var e=t;return this.layers.forEach((function(t){e=t.forward(e)})),e}},{key:"backward",value:function(t,r,n,o){for(var i=t.cols,u=(0,e.K0)().execute("subtract",r,n),a=this.layers.length-1;a>=0;a-=1){var c=this.layers[a].backpropagation(u);u=this.layers[a].getBackPropagation().propagate(t,i,o,c)}}},{key:"loss",value:function(t,e){return this.layers[this.layers.length-1].loss(t,e)}},{key:"error",value:function(t){return 0}},{key:"save",value:function(e){var r={dimensions:this.dimensions,layers:[]};this.layers.forEach((function(t){r.layers.push({type:t.getType(),size:t.getSize(),weights:{W:t.W.data,b:t.b.data}})}));var n=JSON.stringify(r);return new Promise((function(r,o){t.writeFile(e,n,(function(t){t&&(console.error(t),o()),r(n)}))}))}}])&&o(n.prototype,u),r}();function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}!function(t){t.logistic="logistic",t.softmax="softmax",t.tanh="tanh",t.relu="relu",t.softplus="softplus",t.conv="conv",t.maxpool="maxpool",t.fullyconnected="fullyconnected",t.purelin="purelin"}(u||(u={}));var s=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"layer",null),c(this,"previousLayer",null),this.layer=e,this.previousLayer=r},f=r(841);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function b(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(a,t);var r,n,o,i,u=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(o);if(i){var r=d(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return b(this,t)});function a(){return y(this,a),u.apply(this,arguments)}return r=a,(n=[{key:"propagate",value:function(t,r,n,o){var i=null!==this.previousLayer?this.previousLayer.A:t;if(this.layer.gW=(0,e.K0)().execute("multiply",o,i.transpose()),this.layer.gW=(0,e.K0)().execute("multiplyNumber",this.layer.gW,1/r),this.layer.gb=(0,e.K0)().execute("multiplyNumber",o.rowwiseSum().transpose(),1/r),null!==this.previousLayer){var u=(0,e.K0)().execute("multiply",this.layer.W.transpose(),o);if(u.rows!==i.rows||u.cols!==i.cols)throw console.log(this.layer.W.rows,this.layer.W.cols,o.rows,o.cols,this.layer.gW.rows,this.layer.gW.cols),new Error("Dimension error 1. (".concat(u.rows,", ").concat(u.cols,") | (").concat(i.rows,", ").concat(i.cols,")"));if(this.layer.gW.rows!==this.layer.W.rows||this.layer.gW.cols!==this.layer.W.cols)throw new Error("Dimension error 2. (".concat(this.layer.gW.rows,", ").concat(this.layer.gW.cols,") | (").concat(this.layer.W.rows,", ").concat(this.layer.W.cols,")"));if(this.layer.gb.rows!==this.layer.b.rows||this.layer.gb.cols!==this.layer.b.cols)throw new Error("Dimension error 3. (".concat(this.layer.gb.rows,", ").concat(this.layer.gb.cols,") | (").concat(this.layer.b.rows,", ").concat(this.layer.b.cols,")"));return u}return new f.y}}])&&p(r.prototype,n),a}(s);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function O(t,e){return O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},O(t,e)}function S(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=x(n);if(o){var r=x(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return S(this,t)});function u(){return m(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"propagate",value:function(t,e,r,n){return n}}])&&g(e.prototype,r),u}(s),k=r(798);function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function K(t,e){return K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},K(t,e)}function E(t,e){if(e&&("object"===P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return W(t)}function W(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=T(n);if(o){var r=T(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return E(this,t)});function u(){var t;_(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return z(W(t=i.call.apply(i,[this].concat(r))),"previousLayer",null),t}return e=u,(r=[{key:"propagate",value:function(t,e,r,n){var o=this.previousLayer;if(o){for(var i=(0,k.K)().execute("fillZeros",new f.y(o.Z.rows,o.Z.cols)),u=o.getFilterSize(),a=o.getStride(),c=o.getWidth(),s=o.getHeight(),l=(o.getDepth(),o.getOutputWidth()),y=o.getOutputHeight(),p=o.getOutputDepth(),h=0;h<e;h++)for(var b=0;b<p;b++)for(var d=0;d<y;d++)for(var v=0;v<l;v++){for(var w=a*v,m=-1/0,g=s*c*b,O=y*l*b,S=0,x=0,j=0,P=a*d;j<u;j++,P++)for(var _=0,R=w;_<u;_++,R++)o.Z.data&&m<o.Z.data[g+P*c+R][h]&&(m=o.Z.data[g+P*c+R][h],S=R,x=P);i.data&&n.data&&(i.data[g+x*c+S][h]=n.data[O+d*l+v][h])}return i}return new f.y}}])&&R(e.prototype,r),u}(s);function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function M(t,e){return M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},M(t,e)}function L(t,e){if(e&&("object"===C(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return A(t)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}function Z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=F(n);if(o){var r=F(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return L(this,t)});function u(){var t;B(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Z(A(t=i.call.apply(i,[this].concat(r))),"previousLayer",null),t}return e=u,(r=[{key:"propagate",value:function(t,e,r,n){var o=this.previousLayer;if(o){var i=o.getPadding(),u=o.getStride(),a=o.getFilterSize(),c=o.getOutputWidth(),s=o.getOutputHeight(),l=o.getOutputDepth(),y=o.getWidth(),p=o.getHeight(),h=o.getDepth(),b=(0,k.K)().execute("fillZeros",new f.y((y+2*i)*(p+2*i)*h,e)),d=new f.y(y*p*h,e);o.gW=(0,k.K)().execute("fillZeros",o.gW),o.gb=(0,k.K)().execute("fillZeros",o.gb);for(var v=0;v<e;v++){for(var w=0;w<l;w++)for(var m=0;m<s;m++)for(var g=0;g<c;g++){for(var O=u*m,S=u*g,x=0;x<h;x++)for(var j=0,P=O,_=-i;j<a;j++,P++,_++)for(var R=0,K=S,E=-i;R<a;R++,K++,E++){o.W.data&&b.data&&n.data&&(b.data[x*(y+2*i)*(p+2*i)+P*(y+2*i)+K][v]+=o.W.data[w][x*a*a+j*a+R]*n.data[w*c*s+m*c+g][v]);var W=0;0==i?o.Z.data&&(W=o.Z.data[x*y*p+P*y+K][v]):_>=0&&E>=0&&_<p&&E<y&&o.Z.data&&(W=o.Z.data[x*y*p+_*y+E][v]),o.gW.data&&n.data&&(o.gW.data[w][x*a*a+j*a+R]+=W*n.data[w*(c*s)+m*c+g][v]/e)}o.gb.data&&n.data&&(o.gb.data[w][0]+=n.data[w*(c*s)+m*c+g][v]/e)}if(i>0)for(var T=0;T<h;T++)for(var z=-i,D=0;z<p+i;z++,D++)for(var C=-i,B=0;C<y+i;C++,B++)C>=0&&z>=0&&C<y&&z<p&&d.data&&b.data&&(d.data[T*y*p+z*y+C][v]=b.data[T*(y+2*i)*(p+2*i)+D*(y+2*i)+B][v])}return i>0?d:b}}}])&&N(e.prototype,r),u}(s);function H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"create",value:function(t,e){if(null==t){if(e.is1D())return new v(e,t);if(e.getType()==u.conv)return new j(e,t)}else{if(t.getType()==u.maxpool)return new D(e,t);if(t.getType()==u.conv)return new q(e,t);if(t.is1D()||t.getType()==u.fullyconnected)return new v(e,t)}return null}}],null&&H(e.prototype,null),r&&H(e,r),t}();function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function J(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Q=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),J(this,"dimensions",null),J(this,"lastLayer",null),J(this,"network",null),this.dimensions=e,this.network=new a(e)}var e,r;return e=t,r=[{key:"createLayer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.network){var r=new t;"function"==typeof e&&e(r),null===this.lastLayer?this.firstLayerTransition(r):r.transition(this.lastLayer),r.setPreviousLayer(this.lastLayer),r.configure(),r.setBackPropagation(U.create(this.lastLayer,r)),this.network.addLayer(r),this.lastLayer=r}return this}},{key:"getNetwork",value:function(){return this.network}}],r&&I(e.prototype,r),t}();function G(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function V(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var X=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),V(this,"width",0),V(this,"height",0),V(this,"depth",0),V(this,"previousLayer",null),V(this,"backPropagation",null),this.W=new f.y,this.b=new f.y,this.A=new f.y,this.Z=new f.y,this.gW=new f.y,this.gb=new f.y,this.vW=new f.y,this.vb=new f.y,this.sW=new f.y,this.sb=new f.y,this.dW=new f.y,this.db=new f.y}var r,n;return r=t,(n=[{key:"setBackPropagation",value:function(t){return this.backPropagation=t,this}},{key:"setPreviousLayer",value:function(t){this.previousLayer=t}},{key:"getBackPropagation",value:function(){return this.backPropagation}},{key:"forward",value:function(t){return this.Z=(0,e.K0)().execute("add",(0,e.K0)().execute("multiply",this.W,t),this.b.replicate(1,t.cols)),this.A=this.activation(this.Z),this.A}},{key:"setWidth",value:function(t){return this.width=t,this}},{key:"getWidth",value:function(){return this.width}},{key:"setHeight",value:function(t){return this.height=t,this}},{key:"getHeight",value:function(){return this.height}},{key:"setDepth",value:function(t){return this.depth=t,this}},{key:"getDepth",value:function(){return this.depth}},{key:"transition",value:function(t){return this.previousLayer=t,this}},{key:"penalty",value:function(){return(0,e.K0)().execute("penalty",this.W)}}])&&G(r.prototype,n),t}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function $(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function et(t,e,r){return et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=it(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}},et(t,e,r||t)}function rt(t,e){return rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},rt(t,e)}function nt(t,e){if(e&&("object"===Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ot(t)}function ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function it(t){return it=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},it(t)}function ut(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var at=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(a,t);var r,n,o,i,u=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=it(o);if(i){var r=it(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return nt(this,t)});function a(){var t;$(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ut(ot(t=u.call.apply(u,[this].concat(r))),"depth",1),t}return r=a,(n=[{key:"configure",value:function(){var t=this.previousLayer;this.W.resize(this.height,this.width),this.W=(0,e.K0)().execute("fillRandom",this.W,t?t.getHeight():this.height),this.b.resize(this.height,1),this.b=(0,e.K0)().execute("fillRandom",this.b,t?t.getHeight():this.height),this.gW.resize(this.height,this.width),this.gW=(0,e.K0)().execute("fillZeros",this.gW),this.gb.resize(this.height,1),this.gb=(0,e.K0)().execute("fillZeros",this.gb),this.sW.resize(this.height,this.width),this.sW=(0,e.K0)().execute("fillZeros",this.sW),this.sb.resize(this.height,1),this.sb=(0,e.K0)().execute("fillZeros",this.sb),this.vW.resize(this.height,this.width),this.vW=(0,e.K0)().execute("fillZeros",this.vW),this.vb.resize(this.height,1),this.vb=(0,e.K0)().execute("fillZeros",this.sb),this.dW.resize(this.height,this.width),this.dW=(0,e.K0)().execute("fillZeros",this.sW),this.db.resize(this.height,1),this.db=(0,e.K0)().execute("fillZeros",this.sb)}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){return t.is1D()?this.setWidth(t.getSize()):t.is3D()&&this.setWidth(t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth()),et(it(a.prototype),"transition",this).call(this,t),this}},{key:"setSize",value:function(t){return this.setHeight(t),this}},{key:"getSize",value:function(){return this.height}},{key:"getOutputWidth",value:function(){return this.width}},{key:"getOutputHeight",value:function(){return this.height}},{key:"getOutputDepth",value:function(){return 1}}])&&tt(r.prototype,n),a}(X);function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function st(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lt(t,e){return lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},lt(t,e)}function yt(t,e){if(e&&("object"===ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}var ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lt(t,e)}(c,t);var r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=pt(o);if(i){var r=pt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return yt(this,t)});function c(){return st(this,c),a.apply(this,arguments)}return r=c,(n=[{key:"activation",value:function(t){return(0,e.K0)().execute("softmaxActivation",t)}},{key:"getType",value:function(){return u.softmax}},{key:"loss",value:function(t,r){return(0,e.K0)().execute("softmaxLoss",t,r)}},{key:"error",value:function(t){return-1/t}},{key:"backpropagation",value:function(t){return(0,e.K0)().execute("multiply",this.A.transpose(),this.A)}}])&&ft(r.prototype,n),c}(at);function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wt(t,e){return wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},wt(t,e)}function mt(t,e){if(e&&("object"===bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function gt(t){return gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},gt(t)}var Ot=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(c,t);var r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=gt(o);if(i){var r=gt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return mt(this,t)});function c(){return dt(this,c),a.apply(this,arguments)}return r=c,(n=[{key:"activation",value:function(t){return(0,e.K0)().execute("logisticActivation",t)}},{key:"getType",value:function(){return u.logistic}},{key:"loss",value:function(t,r){return(0,e.K0)().execute("logisticLoss",t,r)}},{key:"error",value:function(t){return 1/t}},{key:"backpropagation",value:function(t){return(0,e.K0)().execute("logisticBackpropagation",t,this.A)}}])&&vt(r.prototype,n),c}(at);function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function xt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kt(t,e){return kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},kt(t,e)}function Pt(t,e){if(e&&("object"===St(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_t(t)}var Rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kt(t,e)}(c,t);var r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_t(o);if(i){var r=_t(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Pt(this,t)});function c(){return xt(this,c),a.apply(this,arguments)}return r=c,(n=[{key:"activation",value:function(t){return(0,e.K0)().execute("tanhActivation",t)}},{key:"getType",value:function(){return u.tanh}},{key:"loss",value:function(t,e){return 0}},{key:"error",value:function(t){return 0}}])&&jt(r.prototype,n),c}(at);function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tt(t,e){return Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Tt(t,e)}function zt(t,e){if(e&&("object"===Kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Dt(t){return Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Dt(t)}var Ct=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(c,t);var r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Dt(o);if(i){var r=Dt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return zt(this,t)});function c(){return Et(this,c),a.apply(this,arguments)}return r=c,(n=[{key:"activation",value:function(t){return(0,e.K0)().execute("reluActivation",t)}},{key:"getType",value:function(){return u.relu}},{key:"loss",value:function(t,e){return 0}},{key:"error",value:function(t){return 0}},{key:"backpropagation",value:function(t){return(0,e.K0)().execute("reluBackpropagation",t,this.A)}}])&&Wt(r.prototype,n),c}(at);function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function Nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lt(t,e){return Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Lt(t,e)}function At(t,e){if(e&&("object"===Bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ft(t){return Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(t)}var Zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lt(t,e)}(c,t);var r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ft(o);if(i){var r=Ft(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return At(this,t)});function c(){return Nt(this,c),a.apply(this,arguments)}return r=c,(n=[{key:"activation",value:function(t){return(0,e.K0)().execute("softplusActivation",t)}},{key:"getType",value:function(){return u.softplus}},{key:"loss",value:function(t,e){return 0}},{key:"error",value:function(t){return 0}}])&&Mt(r.prototype,n),c}(at),qt=function(t,e,r,n,o,i,u,a,c,s){for(var l=i*o*e,y=((n-i+2*a)/s+1)*((r-o+2*u)/c+1),p=0,h=(0,k.K)().execute("fillZeros",new f.y(l,y)),b=-u;b+o<=r+u;b+=c)for(var d=-a;d+i<=n+a;d+=s){for(var v=0,w=0;w<e;w++)for(var m=r*n*w,g=0;g<o;g++)for(var O=0;O<i;O++)b+g>=0&&d+O>=0&&d+O<n&&b+g<r&&h.data&&t.data&&h.data[v]&&(h.data[v][p]=t.data[(g+b)*n+d+O+m][0]),v++;p++}return h},Ht=function(t,e,r,n,o,i,u,a){for(var c=(n-i)/a+1,s=(r-o)/u+1,l=e,y=0,p=(0,k.K)().execute("fillZeros",new f.y(c*s*l,1)),h=0;h+o<=r;h+=u)for(var b=0;b+i<=n;b+=a){for(var d=0;d<e;d++){for(var v=-1/0,w=r*n*d,m=c*s*d,g=0;g<o;g++)for(var O=0;O<i;O++)v=Math.max(v,t.data[w+(g+h)*n+b+O][0]);p.data&&(p.data[m+y][0]=v)}y++}return new f.y},Ut=function(t,e){return Math.round((t+Number.EPSILON)*Math.pow(10,e))/Math.pow(10,e)};function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Jt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Gt(t,e,r){return Gt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}},Gt(t,e,r||t)}function Vt(t,e){return Vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Vt(t,e)}function Xt(t,e){if(e&&("object"===It(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Yt(t){return Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Yt(t)}var $t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vt(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yt(n);if(o){var r=Yt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Xt(this,t)});function u(){return Jt(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"configure",value:function(){}},{key:"is1D",value:function(){return!1}},{key:"is3D",value:function(){return!0}},{key:"transition",value:function(t){return t.is3D()&&this.setSize([t.getOutputWidth(),t.getOutputHeight(),t.getOutputDepth()]),Gt(Yt(u.prototype),"transition",this).call(this,t),this}},{key:"setSize",value:function(t){return this.setWidth(t[0]),this.setHeight(t[1]),this.setDepth(t[2]),this}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight(),this.getDepth()]}}])&&Qt(e.prototype,r),u}(X);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ne(t,e){return ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ne(t,e)}function oe(t,e){if(e&&("object"===te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ie(t)}function ie(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ue(t)}function ae(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ce=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ne(t,e)}(c,t);var r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ue(o);if(i){var r=ue(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return oe(this,t)});function c(){var t;ee(this,c);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ae(ie(t=a.call.apply(a,[this].concat(r))),"numFilters",32),ae(ie(t),"filterSize",4),ae(ie(t),"padding",1),ae(ie(t),"stride",1),t}return r=c,(n=[{key:"configure",value:function(){this.W.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.W=(0,e.K0)().execute("fillRandom",this.W,this.width*this.height*this.depth),this.b.resize(this.numFilters,1),this.b=(0,e.K0)().execute("fillRandom",this.b,.01),this.gW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.gW=(0,e.K0)().execute("fillZeros",this.gW),this.gb.resize(this.numFilters,1),this.gb=(0,e.K0)().execute("fillZeros",this.gb),this.sW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.sW=(0,e.K0)().execute("fillZeros",this.gb),this.sb.resize(this.numFilters,1),this.sb=(0,e.K0)().execute("fillZeros",this.sb),this.vW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.vW=(0,e.K0)().execute("fillZeros",this.vW),this.vb.resize(this.numFilters,1),this.vb=(0,e.K0)().execute("fillZeros",this.vb)}},{key:"getOutputHeight",value:function(){return(this.width-this.filterSize+2*this.padding)/this.stride+1}},{key:"getOutputWidth",value:function(){return(this.height-this.filterSize+2*this.padding)/this.stride+1}},{key:"getOutputDepth",value:function(){return this.numFilters}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"getFilterSize",value:function(){return this.filterSize}},{key:"setNumFilters",value:function(t){return this.numFilters=t,this}},{key:"getNumFilters",value:function(){return this.numFilters}},{key:"setPadding",value:function(t){return this.padding=t,this}},{key:"getPadding",value:function(){return this.padding}},{key:"setStride",value:function(t){return this.stride=t,this}},{key:"getStride",value:function(){return this.stride}},{key:"forward",value:function(t){for(var r=new f.y(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth(),t.cols),n=0;n<t.cols;n+=1){var o=qt(t.col(n),this.depth,this.height,this.width,this.filterSize,this.filterSize,this.padding,this.padding,this.stride,this.stride),i=(0,e.K0)().execute("add",(0,e.K0)().execute("multiply",this.W,o),this.b.replicate(1,t.cols));r.setCol(n,i.rollToColMatrix())}return this.Z=r,this.activation(this.Z),this.A}},{key:"activation",value:function(t){return(0,e.K0)().execute("reluActivation",t)}},{key:"getType",value:function(){return u.conv}},{key:"loss",value:function(t,e){throw new Error("Unsupported.")}},{key:"error",value:function(t){throw new Error("Unsupported.")}}])&&re(r.prototype,n),c}($t);function se(t){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(t)}function fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ye(t,e){return ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ye(t,e)}function pe(t,e){if(e&&("object"===se(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function he(t){return he=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},he(t)}var be=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ye(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=he(n);if(o){var r=he(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return pe(this,t)});function a(){return fe(this,a),i.apply(this,arguments)}return e=a,(r=[{key:"configure",value:function(){}},{key:"transition",value:function(t){if(!t.is3D())throw new Error("Invalid usage. Cannot fully connect with previous 1D Layer.");if(t.getType()!=u.maxpool)throw new Error("Invalid usage. Cannot fully connect with previous non maxpool Layer.");return this.filterSize=t.getOutputWidth(),this.padding=0,this.stride=1,this.width=t.getOutputWidth(),this.height=t.getOutputHeight(),this.depth=t.getOutputDepth(),this.numFilters=t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth(),this}},{key:"setSize",value:function(t){return this}},{key:"setFilterSize",value:function(t){return this}},{key:"setStride",value:function(t){return this}},{key:"setPadding",value:function(t){return this}},{key:"setWidth",value:function(t){return this}},{key:"setHeight",value:function(t){return this}},{key:"setDepth",value:function(t){return this}},{key:"setNumFilters",value:function(t){return this}}])&&le(e.prototype,r),a}(ce);function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function we(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function me(t,e){return me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},me(t,e)}function ge(t,e){if(e&&("object"===de(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Oe(t)}function Oe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Se(t)}function xe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var je=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&me(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Se(n);if(o){var r=Se(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ge(this,t)});function a(){var t;ve(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return xe(Oe(t=i.call.apply(i,[this].concat(r))),"filterSize",0),xe(Oe(t),"stride",0),t}return e=a,(r=[{key:"configure",value:function(){}},{key:"getOutputHeight",value:function(){return(this.height-this.filterSize)/this.stride+1}},{key:"getOutputWidth",value:function(){return(this.width-this.filterSize)/this.stride+1}},{key:"getOutputDepth",value:function(){return this.depth}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"getFilterSize",value:function(){return this.filterSize}},{key:"setStride",value:function(t){return this.stride=t,this}},{key:"getStride",value:function(){return this.stride}},{key:"getPadding",value:function(){return 0}},{key:"forward",value:function(t){for(var e=new f.y(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth(),t.cols),r=0;r<t.cols;r+=1){var n=Ht(t.col(r),this.depth,this.height,this.width,this.filterSize,this.filterSize,this.stride,this.stride).rollToColMatrix();e.setCol(r,n)}return this.Z=e,this.activation(this.Z),this.A}},{key:"activation",value:function(t){throw new Error("No activation for MAXPOOL Layer.")}},{key:"getType",value:function(){return u.maxpool}},{key:"loss",value:function(t,e){throw new Error("Unsupported.")}},{key:"error",value:function(t){throw new Error("Unsupported.")}}])&&we(e.prototype,r),a}($t);function ke(t){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ke(t)}function Pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Re(t,e){return Re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Re(t,e)}function Ke(t,e){if(e&&("object"===ke(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ee(t){return Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ee(t)}var We=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Re(t,e)}(c,e);var r,n,o,i,u,a=(i=c,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ee(i);if(u){var r=Ee(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ke(this,t)});function c(){return Pe(this,c),a.apply(this,arguments)}return r=c,o=[{key:"fromJSON",value:function(e){return new Promise((function(r,n){t.readFile(e,(function(t,e){if(t)n(t);else{var o=JSON.parse(e.toString()),i=new c(o.dimensions);o.layers.forEach((function(t){var e=null;"logistic"===t.type?e=Ot:"softmax"===t.type?e=ht:"relu"===t.type?e=Ct:"softplus"===t.type?e=Zt:"tanh"===t.type&&(e=Rt),i.createLayer(e,(function(e){e.setSize(t.size)}))}));var u=i.getNetwork();u&&(u.getLayers().forEach((function(t,e){t.W=new f.y(o.layers[e].weights.W.length,o.layers[e].weights.W[0].length,o.layers[e].weights.W),t.b=new f.y(o.layers[e].weights.b.length,o.layers[e].weights.b[0].length,o.layers[e].weights.b)})),r(u))}}))}))}}],(n=[{key:"firstLayerTransition",value:function(t){t.setWidth(this.dimensions[0])}}])&&_e(r.prototype,n),o&&_e(r,o),c}(Q);function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function ze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ce(t,e){return Ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ce(t,e)}function Be(t,e){if(e&&("object"===Te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(t)}var Me=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ce(t,e)}(c,e);var r,n,o,i,u,a=(i=c,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ne(i);if(u){var r=Ne(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Be(this,t)});function c(){return ze(this,c),a.apply(this,arguments)}return r=c,o=[{key:"fromJSON",value:function(e){return new Promise((function(r,n){t.readFile(e,(function(t,e){if(t)n(t);else{var o=JSON.parse(e.toString()),i=new c(o.size);o.layers.forEach((function(t){"logistic"===t.type?i.createLayer(Ot,(function(e){e.setSize(t.size)})):"softmax"===t.type?i.createLayer(ht,(function(e){e.setSize(t.size)})):"relu"===t.type?i.createLayer(Ct,(function(e){e.setSize(t.size)})):"softplus"===t.type?i.createLayer(Zt,(function(e){e.setSize(t.size)})):"tanh"===t.type?i.createLayer(Rt,(function(e){e.setSize(t.size)})):"conv"===t.type?i.createLayer(ce,(function(e){e.setSize(t.size),e.setFilterSize(t.filterSize),e.setStride(t.stride),e.setNumFilters(t.numFilters),e.setPadding(t.padding)})):"maxpool"===t.type?i.createLayer(je,(function(e){e.setSize(t.size),e.setFilterSize(t.filterSize),e.setStride(t.stride)})):"fullyconnected"===t.type&&i.createLayer(je)}));var u=i.getNetwork();u&&(u.getLayers().forEach((function(t,e){t.W=o.layers.W,t.b=o.layers.b})),r(u))}}))}))}}],(n=[{key:"firstLayerTransition",value:function(t){this.dimensions&&t.setSize(this.dimensions)}}])&&De(r.prototype,n),o&&De(r,o),c}(Q);function Le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Fe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ze=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Le(this,t),Fe(this,"exampleSize",0),Fe(this,"numberOfExamples",0),Fe(this,"data",null),this.exampleSize=e,this.numberOfExamples=r,n){for(var o=[],i=0;i<e;i+=1){o[i]=new Array(r);for(var u=0;u<r;u+=1)"string"==typeof n[i][u]?o[i][u]=n[i][u].length?Number(n[i][u]):NaN:"number"==typeof n[i][u]&&(o[i][u]=n[i][u])}this.data=new f.y(this.exampleSize,this.numberOfExamples,o)}}var e,r,n;return e=t,n=[{key:"fromMatrix",value:function(e){var r=new t;return r.exampleSize=e.rows,r.numberOfExamples=e.cols,r.data=e,r}}],(r=[{key:"exampleAt",value:function(t){return this.data.col(t)}},{key:"getNumberOfExamples",value:function(){return this.numberOfExamples}},{key:"getExampleSize",value:function(){return this.exampleSize}},{key:"getBatch",value:function(e,r){var n=this.data.block(0,e,this.data.rows,r);return t.fromMatrix(n)}}])&&Ae(e.prototype,r),n&&Ae(e,n),t}();function qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var He=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"fromSource",value:function(t){return new Promise((function(e){t.then((function(t){var r=t.parse(),n=r.cols,o=r.rows,i=new Ze(o,n,r.data);e(i)}))}))}}],null&&qe(e.prototype,null),r&&qe(e,r),t}();function Ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Je=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ie(this,"batchSize",0),Ie(this,"t",0),Ie(this,"learningRate",0)}var e,r;return e=t,(r=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}}])&&Ue(e.prototype,r),t}();function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function Ge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xe(t,e){return Xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xe(t,e)}function Ye(t,e){if(e&&("object"===Qe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $e(t)}function $e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tr(t){return tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},tr(t)}function er(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var rr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xe(t,e)}(a,t);var r,n,o,i,u=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=tr(o);if(i){var r=tr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ye(this,t)});function a(){var t;Ge(this,a);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return er($e(t=u.call.apply(u,[this].concat(r))),"beta1",.9),er($e(t),"beta2",.999),t}return r=a,(n=[{key:"setBeta1",value:function(t){return this.beta1=t,this}},{key:"setBeta2",value:function(t){return this.beta2=t,this}},{key:"optimize",value:function(t){this.adam(t,this.learningRate,this.t)}},{key:"adam",value:function(t,r,n){t.vW=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.vW,this.beta1),(0,e.K0)().execute("multiplyNumber",t.gW,1-this.beta1));var o=(0,e.K0)().execute("divideNumber",t.vW,1-Math.pow(this.beta1,n));t.sW=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.sW,this.beta2),(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("pow",t.gW,2),1-this.beta2));var i=(0,e.K0)().execute("divideNumber",t.sW,1-Math.pow(this.beta2,this.t));t.W=(0,e.K0)().execute("subtract",t.W,(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("elementWiseDivide",o,(0,e.K0)().execute("sqrt",i)),r)),t.vb=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.vb,this.beta1),(0,e.K0)().execute("multiplyNumber",t.gb,1-this.beta1));var u=(0,e.K0)().execute("divideNumber",t.vb,1-Math.pow(this.beta1,n));t.sb=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.sb,this.beta2),(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("elementWiseMultiply",t.gb,t.gb),1-this.beta2));var a=(0,e.K0)().execute("divideNumber",t.sb,1-Math.pow(this.beta2,n));t.b=(0,e.K0)().execute("subtract",t.b,(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("elementWiseDivide",u,(0,e.K0)().execute("sqrt",a)),r))}}])&&Ve(r.prototype,n),a}(Je);function nr(t){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nr(t)}function or(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ir(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ur(t,e){return ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ur(t,e)}function ar(t,e){if(e&&("object"===nr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function cr(t){return cr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cr(t)}var sr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ur(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=cr(n);if(o){var r=cr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ar(this,t)});function u(){return or(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"optimize",value:function(t){this.gradientDescent(t,this.learningRate)}},{key:"gradientDescent",value:function(t,e){t.W=(0,k.K)().execute("subtract",t.W,(0,k.K)().execute("multiplyNumber",t.gW,e)),t.b=(0,k.K)().execute("subtract",t.b,(0,k.K)().execute("multiplyNumber",t.gb,e))}}])&&ir(e.prototype,r),u}(Je);function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function lr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pr(t,e){return pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pr(t,e)}function hr(t,e){if(e&&("object"===fr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function br(t){return br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},br(t)}var dr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pr(t,e)}(a,t);var r,n,o,i,u=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=br(o);if(i){var r=br(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return hr(this,t)});function a(){return lr(this,a),u.apply(this,arguments)}return r=a,(n=[{key:"optimize",value:function(t){this.adadelta(t,this.learningRate,this.t)}},{key:"adadelta",value:function(t,r,n){var o=.9;t.sW=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.sW,o),(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("elementWiseMultiply",t.gW,t.gW),1-o));var i=(0,e.K0)().execute("elementWiseMultiply",(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("elementWiseDivide",(0,e.K0)().execute("sqrt",t.vW),(0,e.K0)().execute("sqrt",t.sW)),-1),t.gW);t.vW=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.sW,o),(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("pow",i,2),1-o)),t.W=(0,e.K0)().execute("add",t.W,i),t.sb=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.gb,o),(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("elementWiseMultiply",t.gb,t.gb),1-o));var u=(0,e.K0)().execute("elementWiseMultiply",(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("elementWiseDivide",(0,e.K0)().execute("sqrt",t.vb),t.sb),-1),t.gb);t.vb=(0,e.K0)().execute("add",(0,e.K0)().execute("multiplyNumber",t.sb,o),(0,e.K0)().execute("multiplyNumber",(0,e.K0)().execute("pow",t.sb,2),1-o)),t.b=(0,e.K0)().execute("elementWiseMultiply",t.b,u)}}])&&yr(r.prototype,n),a}(Je);function vr(t){return vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vr(t)}function wr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gr(t,e){return gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},gr(t,e)}function Or(t,e){if(e&&("object"===vr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Sr(t)}function Sr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xr(t){return xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},xr(t)}function jr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gr(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=xr(n);if(o){var r=xr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Or(this,t)});function u(){var t;wr(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return jr(Sr(t=i.call.apply(i,[this].concat(r))),"beta",.9),t}return e=u,(r=[{key:"optimize",value:function(t){this.momentum(t,this.learningRate)}},{key:"setBeta",value:function(t){return this.beta=t,this}},{key:"momentum",value:function(t,e){t.vW=(0,k.K)().execute("add",(0,k.K)().execute("multiplyNumber",t.vW,this.beta),(0,k.K)().execute("multiplyNumber",t.gW,1-this.beta)),t.vb=(0,k.K)().execute("add",(0,k.K)().execute("multiplyNumber",t.vb,this.beta),(0,k.K)().execute("multiplyNumber",t.gb,1-this.beta)),t.W=(0,k.K)().execute("subtract",t.W,(0,k.K)().execute("multiplyNumber",t.vW,e)),t.b=(0,k.K)().execute("subtract",t.b,(0,k.K)().execute("multiplyNumber",t.vb,e))}}])&&mr(e.prototype,r),u}(Je);function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function _r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kr(t,e){return Kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Kr(t,e)}function Er(t,e){if(e&&("object"===Pr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wr(t)}function Wr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tr(t){return Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tr(t)}function zr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Dr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kr(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Tr(n);if(o){var r=Tr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Er(this,t)});function u(){var t;_r(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return zr(Wr(t=i.call.apply(i,[this].concat(r))),"batchSize",100),t}return e=u,(r=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"train",value:function(t,e){var r=this,n=t.getNumberOfExamples(),o=0;this.optimizer.setBatchSize(this.batchSize),this.optimizer.setLearningRate(this.learningRate);for(var i=0;i<this.iterations;i+=1){for(var u=(new Date).getTime(),a=(new Date).getTime(),c=0,s=0;c<n;c+=this.batchSize,s+=this.batchSize){var f=(new Date).getTime(),l=t.getBatch(s,this.batchSize),y=e.getBatch(s,this.batchSize),p=this.network.forward(l.data);if(this.network.backward(l.data,y.data,p,this.regularization),this.optimizer.setT(++o),this.network.getLayers().forEach((function(t){r.optimizer.optimize(t)})),this.verbose){var h=(new Date).getTime();console.log("Batch: ".concat(s," / ").concat(n," | Batch time: ").concat(h-f,"ms | Time from start: ").concat(Ut((h-a)/1e3,1),"s."))}}if(this.verbose&&(i+1)%this.verboseStep==0){var b=(new Date).getTime(),d=this.cost(t,e);console.log("Iteration: ".concat(i+1," | Cost: ").concat(Ut(d.cost,5)," | Accuracy: ").concat(d.accuracy,"% | Time: ").concat((b-u)/100," s."))}"function"==typeof this.stepCallback&&this.stepCallback.call(null,{iteration:i})}return this}}])&&Rr(e.prototype,r),u}(r(35).J),Cr=function t(e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(r="dataset")in this?Object.defineProperty(this,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[r]=null,this.dataset=e};function Br(t){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Br(t)}function Nr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lr(t,e){return Lr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Lr(t,e)}function Ar(t,e){if(e&&("object"===Br(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Fr(t)}function Fr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zr(t){return Zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Zr(t)}function qr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Hr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lr(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Zr(n);if(o){var r=Zr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ar(this,t)});function u(){var t;Nr(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return qr(Fr(t=i.call.apply(i,[this].concat(r))),"callback",(function(t){return t})),t}return e=u,(r=[{key:"apply",value:function(){for(var t=0;t<this.dataset.getNumberOfExamples();t+=1)for(var e=this.callback(this.dataset.exampleAt(t)),r=0;r<this.dataset.data.rows;r+=1)e&&(this.dataset.data.data[r][t]=e.data[r][0]);return this.dataset}},{key:"setCallback",value:function(t){return this.callback=t,this}}])&&Mr(e.prototype,r),u}(Cr);function Ur(t){return Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ur(t)}function Ir(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qr(t,e){return Qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Qr(t,e)}function Gr(t,e){if(e&&("object"===Ur(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vr(t){return Vr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Vr(t)}var Xr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qr(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Vr(n);if(o){var r=Vr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Gr(this,t)});function u(){return Ir(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"apply",value:function(){for(var t=1/0,e=-1/0,r=0;r<this.dataset.getNumberOfExamples();r+=1)for(var n=this.dataset.exampleAt(r),o=0;o<n.rows;o+=1)t>n.data[o][0]&&(t=n.data[o][0]),e<n.data[o][0]&&(e=n.data[o][0]);for(var i=0;i<this.dataset.getNumberOfExamples();i+=1)for(var u=this.dataset.exampleAt(i),a=0;a<u.rows;a+=1)this.dataset.data.data[a][i]=(u.data[a][0]-t)/(e-t);return this.dataset}}])&&Jr(e.prototype,r),u}(Cr);function Yr(t){return Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yr(t)}function $r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function en(t,e){return en=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},en(t,e)}function rn(t,e){if(e&&("object"===Yr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return nn(t)}function nn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function on(t){return on=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},on(t)}function un(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var an=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&en(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=on(n);if(o){var r=on(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return rn(this,t)});function u(){var t;$r(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return un(nn(t=i.call.apply(i,[this].concat(r))),"modificationType","mean"),t}return e=u,(r=[{key:"apply",value:function(){for(var t=this,e=[],r=0,n=0,o=0,i=0;i<this.dataset.getNumberOfExamples();i+=1)for(var u=this.dataset.exampleAt(i),a=0;a<this.dataset.getExampleSize();a+=1)isNaN(u.data[a][0])||void 0===u.data[a][0]?e.push({row:a,col:u}):(n+=u.data[a][0],r++);return"mean"===this.modificationType&&(o=n/r),e.forEach((function(e){var r=e.row,n=e.col;t.dataset&&t.dataset.data&&t.dataset.data.data&&(t.dataset.data.data[r][n]=o)})),this.dataset}},{key:"setModificationType",value:function(t){return this.modificationType=t,this}}])&&tn(e.prototype,r),u}(Cr),cn=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)};const sn=require("csvtojson");function fn(t){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fn(t)}function ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yn(t,e){return yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yn(t,e)}function pn(t,e){if(e&&("object"===fn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return hn(t)}function hn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bn(t){return bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bn(t)}function dn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var vn;!function(t){t[t.UnquotedField=0]="UnquotedField",t[t.QuotedField=1]="QuotedField",t[t.QuotedQuote=2]="QuotedQuote"}(vn||(vn={}));var wn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yn(t,e)}(a,t);var e,r,n,o,i,u=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=bn(o);if(i){var r=bn(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return pn(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),dn(hn(e=u.call(this)),"data",null),dn(hn(e),"matrixData",null),e.data=t,e}return e=a,n=[{key:"fromLocalFile",value:function(t){return new Promise((function(e){sn({noheader:!0,output:"csv"}).fromFile(t).then((function(t){e(new a(t))}))}))}}],(r=[{key:"parse",value:function(){var t=this.data.length,e=this.data[0].length;return new f.y(t,e,this.data).transpose()}}])&&ln(e.prototype,r),n&&ln(e,n),a}(cn),mn={NetworkBuilder1D:We,NetworkBuilder3D:Me},gn={Matrix:f.y},On={SoftmaxLayer:ht,LogisticLayer:Ot,ReluLayer:Ct,SoftplusLayer:Zt,TanhLayer:Rt,ConvLayer:ce,MaxPoolLayer:je,FullyConnectedLayer:be},Sn={DatasetBuilder:He},xn={OptimizerAdam:rr,OptimizerGradientDescent:sr,OptimizerAdadelta:dr,OptimizerMomentum:kr},jn={MiniBatchTrainer:Dr},kn={CallbackDatabaseModifier:Hr,MinMaxScalingDatabaseModifier:Xr,MissingDataScalingDatabaseModifier:an},Pn={ComputationCPU:e.CU,ComputationGPU:e.d_,setComputation:e.fR,getComputation:e.K0},_n={Dataset:Ze},Rn={DatasetBuilderSourceCSV:wn}})(),module.exports=n})();
//# sourceMappingURL=impulse-ts.js.map