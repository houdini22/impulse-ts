(()=>{var t={846:(t,e,r)=>{t=r.nmd(t);try{process.dlopen(t,__dirname+r(622).sep+r.p+"202c32a4ae9e32b7853b0812ae623972.node")}catch(t){throw new Error("node-loader:\n"+t)}},622:t=>{"use strict";t.exports=require("path")}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n](i,i.exports,r),i.loaded=!0,i.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r.p="";var n={};(()=>{"use strict";r.r(n),r.d(n,{Builder1D:()=>_,LogisticLayer:()=>et,Matrix:()=>a,SoftmaxLayer:()=>J,matrixElementWiseAdd:()=>c,matrixElementWiseDivide:()=>w,matrixElementWiseMultiply:()=>y,matrixElementWiseSubtract:()=>f,matrixFillRandom:()=>l,matrixMultiply:()=>s,matrixSum:()=>p});var t=r(846);const e=require("gpu.js");function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Array(e*r);o(this,t),u(this,"rows",0),u(this,"cols",0),u(this,"data",null),this.resize(e,r),this.generateData(n)}var e,r;return e=t,(r=[{key:"resize",value:function(t,e){return this.rows=t,this.cols=e,this.data=Float64Array.from(new Array(t*e)),this}},{key:"generateData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Array;return this.data=Float64Array.from(t),this}},{key:"toBuffer",value:function(){var t=new ArrayBuffer(this.rows*this.cols*64),e=new DataView(t,0,this.rows*this.cols*64);return this.data.forEach((function(t,r){e.setFloat64(r,t)})),t}},{key:"sum",value:function(){var t=0;return this.data.forEach((function(e){t+=e})),t}},{key:"colwiseSum",value:function(){for(var e=new Array(this.rows),r=0;r<this.rows;r+=1){for(var n=0,o=0;o<this.cols;o+=1)n+=this.data[r*o];e[r]=n}return new t(this.rows,1,e)}},{key:"replicate",value:function(t,e){return this}}])&&i(e.prototype,r),t}(),s=function(t,r){if(t.cols!==r.rows)throw new Error("DIMENSIONS error.");var n=(new e.GPU).createKernel((function(t,e){for(var r=0,n=0;n<this.constants.cols;n++)r+=t[this.thread.x][n]*e[n][this.thread.y];return r})).setOutput([t.rows*r.cols]).setConstants({cols:t.rows})((0,e.input)(t.data,[t.rows,t.cols]),(0,e.input)(r.data,[r.rows,r.cols]));return new a(t.rows,r.cols,Array.from(n))},c=function(t,r){if(t.rows!==r.rows)throw new Error("ROWS number not equal.");if(t.cols!==r.cols)throw new Error("COLS number not equal.");var n=(new e.GPU).createKernel((function(t,e){return t[this.thread.x][this.thread.y]+e[this.thread.x][this.thread.y]})).setOutput([t.rows*r.cols])((0,e.input)(t.data,[t.rows,t.cols]),(0,e.input)(r.data,[r.rows,r.cols]));return new a(t.rows,r.cols,Array.from(n))},f=function(t,r){if(t.rows!==r.rows)throw new Error("ROWS number not equal.");if(t.cols!==r.cols)throw new Error("COLS number not equal.");var n=(new e.GPU).createKernel((function(t,e){return t[this.thread.x][this.thread.y]-e[this.thread.x][this.thread.y]})).setOutput([t.cols*t.rows])((0,e.input)(t.data,[t.rows,t.cols]),(0,e.input)(r.data,[r.rows,r.cols]));return new a(t.rows,r.cols,Array.from(n))},l=function(t,r){var n=(new e.GPU).createKernel((function(t){return Math.random()*Math.sqrt(2/this.constants.parameter)})).setOutput([t.cols*t.rows]).setConstants({parameter:r})((0,e.input)(t.data,[t.rows,t.cols]));return new a(t.rows,t.cols,Array.from(n))},h=function(t){var r=(new e.GPU).createKernel((function(t){return 0})).setOutput([t.cols*t.rows])((0,e.input)(t.data,[t.rows,t.cols]));return new a(t.rows,t.cols,Array.from(r))},y=function(t,r){if(t.rows!==r.rows)throw new Error("ROWS number not equal.");if(t.cols!==r.cols)throw new Error("COLS number not equal.");var n=(new e.GPU).createKernel((function(t,e){return t[this.thread.x][this.thread.y]*e[this.thread.x][this.thread.y]})).setOutput([t.cols*t.rows])((0,e.input)(t.data,[t.rows,t.cols]),(0,e.input)(r.data,[r.rows,r.cols]));return new a(t.rows,r.cols,Array.from(n))},p=function(t){return t.sum()},w=function(t,r){if(t.rows!==r.rows)throw new Error("ROWS number not equal.");if(t.cols!==r.cols)throw new Error("COLS number not equal.");var n=(new e.GPU).createKernel((function(t,e){return t[this.thread.x][this.thread.y]/e[this.thread.x][this.thread.y]})).setOutput([t.cols*t.rows])((0,e.input)(t.data,[t.rows,t.cols]),(0,e.input)(r.data,[r.rows,r.cols]));return new a(t.rows,r.cols,Array.from(n))};const d=require("fs");function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),v(this,"dimensions",null),v(this,"size",0),v(this,"layers",[]),this.dimensions=e}var e,r;return e=t,(r=[{key:"addLayer",value:function(t){this.size++,this.layers.push(t)}},{key:"forward",value:function(t){var e=t;return this.layers.forEach((function(t){e=t.forward(e)})),e}},{key:"backward",value:function(t,e,r,n){t.cols,f(r,e),this.layers.reverse().forEach((function(t){}))}},{key:"save",value:function(t){var e={dimensions:this.dimensions,layers:[]};this.layers.forEach((function(t){e.layers.push({type:t.getType(),dimensions:[t.getOutputHeight(),t.getOutputWidth(),t.getOutputDepth()],weights:{W:t.W.data,b:t.b.data}})}));var r=JSON.stringify(e);return new Promise((function(e,n){d.writeFile(t,r,(function(t){t&&(console.error(t),n()),e(r)}))}))}}])&&b(e.prototype,r),t}();function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function O(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function j(t,e){return(j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e){if(e&&("object"===k(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&j(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=E(n);if(o){var r=E(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return x(this,t)});function u(){return S(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"firstLayerTransition",value:function(t){t.setWidth(this.dimensions[0])}}])&&P(e.prototype,r),u}(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),O(this,"dimensions",null),O(this,"previousLayer",null),O(this,"network",null),this.dimensions=e,this.network=new m(e)}var e,r;return e=t,(r=[{key:"createLayer",value:function(t,e){var r=new t;"function"==typeof e&&e(r),null===this.previousLayer?this.firstLayerTransition(r):r.transition(this.previousLayer),r.configure(),this.network.addLayer(r),this.previousLayer=r}},{key:"getNetwork",value:function(){return this.network}}])&&g(e.prototype,r),t}());function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function W(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var A,T=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),W(this,"width",0),W(this,"height",0),W(this,"depth",0),W(this,"previousLayer",null),this.W=new a,this.b=new a,this.A=new a,this.Z=new a,this.gW=new a,this.gb=new a}var e,r;return e=t,(r=[{key:"forward",value:function(t){return this.Z=c(s(this.W,t),this.b),this.A=this.activation(this.Z),this.A}},{key:"setWidth",value:function(t){this.width=t}},{key:"getWidth",value:function(){return this.width}},{key:"setHeight",value:function(t){this.height=t}},{key:"getHeight",value:function(){return this.height}},{key:"setDepth",value:function(t){this.depth=t}},{key:"getDepth",value:function(){return this.depth}}])&&R(e.prototype,r),t}();function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function q(t,e){return(q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return U(t)}function U(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}!function(t){t.logistic="logistic",t.softmax="softmax"}(A||(A={}));var G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&q(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=z(n);if(o){var r=z(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return M(this,t)});function u(){var t;L(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return B(U(t=i.call.apply(i,[this].concat(r))),"depth",1),t}return e=u,(r=[{key:"configure",value:function(){this.W.resize(this.height,this.width),this.W=l(this.W,this.width),this.b.resize(this.height,1),this.b=l(this.b,this.width),this.gW.resize(this.height,this.width),this.gW=h(this.gW),this.gb.resize(this.height,1),this.gb=h(this.gb)}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){t.is1D()?this.setWidth(t.getSize()):t.is3D()&&this.setWidth(t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth())}},{key:"setSize",value:function(t){this.setHeight(t[0])}},{key:"getSize",value:function(){return this.height}},{key:"getOutputWidth",value:function(){return this.width}},{key:"getOutputHeight",value:function(){return this.height}},{key:"getOutputDepth",value:function(){return 1}}])&&C(e.prototype,r),u}(T);function K(t){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Z(t,e){if(e&&("object"===K(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var J=function(r){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}(c,r);var n,o,i,u,s=(i=c,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=I(i);if(u){var r=I(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Z(this,t)});function c(){return H(this,c),s.apply(this,arguments)}return n=c,(o=[{key:"activation",value:function(t){return function(t){var r=(new e.GPU).createKernel((function(t){return Math.exp(t[this.thread.x][this.thread.y])})).setOutput([t.cols*t.rows]),n=new a(t.rows,t.cols,Array.from(r((0,e.input)(t.data,[t.rows,t.cols])))),o=new a(t.rows,1,n.colwiseSum().data).replicate(t.rows,1);return new a(t.rows,t.cols,w(n,o).data)}(t)}},{key:"derivative",value:function(){throw new Error("Unsupported usage.")}},{key:"getType",value:function(){return A.softmax}},{key:"loss",value:function(e,r){return o=r,(i=new a((n=e).rows,n.cols)).data=(0,t.SoftmaxLoss)(n.data,n.rows,n.cols,o.data,o.rows,o.cols),(0,t.MatrixSum)(i,i.rows,i.cols);var n,o,i}},{key:"error",value:function(t){return-1/t}}])&&F(n.prototype,o),c}(G);function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $(t,e){if(e&&("object"===V(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(s,t);var r,n,o,i,u=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=tt(o);if(i){var r=tt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return $(this,t)});function s(){return Q(this,s),u.apply(this,arguments)}return r=s,(n=[{key:"activation",value:function(t){return function(t){var r=(new e.GPU).createKernel((function(t){return 1/(1+Math.exp(-t[this.thread.x][this.thread.y]))})).setOutput([t.cols*t.rows])((0,e.input)(t.data,[t.rows,t.cols]));return new a(t.rows,t.cols,Array.from(r))}(t)}},{key:"derivative",value:function(){return t=this.A,r=(new e.GPU).createKernel((function(t){return t[this.thread.x][this.thread.y]*(1-t[this.thread.x][this.thread.y])})).setOutput([t.cols*t.rows])((0,e.input)(t.data,[t.rows,t.cols])),new a(t.rows,t.cols,Array.from(r));var t,r}},{key:"getType",value:function(){return A.logistic}},{key:"loss",value:function(t,r){return function(t,r){var n=(new e.GPU).createKernel((function(t){return Math.log(t[this.thread.x][this.thread.y])})).setOutput([t.cols*t.rows]),o=new a(t.rows,t.cols,n((0,e.input)(t.data,[t.rows,t.cols])));return f(o,r).sum()}(t,r)}},{key:"error",value:function(t){return-1/t}}])&&X(r.prototype,n),s}(G)})(),module.exports=n})();
//# sourceMappingURL=impulse-ts.js.map