(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Builders:()=>Qn,Computations:()=>oo,Dataset:()=>to,DatasetModifiers:()=>no,Layers:()=>$n,Math:()=>Yn,Optimizers:()=>eo,Trainers:()=>ro});const r=require("fs");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(){var e,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r={},(e="kernels")in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r}var e,r;return e=t,r=[{key:"addKernel",value:function(t,e){return this.kernels[t]=e,this}},{key:"execute",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return this.kernels[t].apply(null,r)}}],r&&n(e.prototype,r),t}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i(this,t),c(this,"rows",0),c(this,"cols",0),c(this,"data",null),this.resize(e,r),n&&this.generateData(n)}var e,r;return e=t,(r=[{key:"resize",value:function(t,e){this.rows=t,this.cols=e,this.data=[];for(var r=0;r<this.rows;r+=1)this.data[r]=new Array(this.cols);return this}},{key:"generateData",value:function(t){this.data=[];for(var e=0;e<this.rows;e+=1)this.data[e]=new Array(this.cols);for(var r=0;r<this.cols;r+=1)for(var n=0;n<this.rows;n+=1)"number"==typeof t[r]?this.data[n][r]=t[r]:t[r]instanceof Float32Array?this.data[n][r]=t[r][n]:this.data[n][r]=0;return this}},{key:"toBuffer",value:function(){var t=new ArrayBuffer(this.rows*this.cols*64),e=new DataView(t,0,this.rows*this.cols*64);return this.data.forEach((function(t,r){e.setFloat64(r,t)})),t}},{key:"sum",value:function(){for(var t=0,e=0;e<this.rows;e+=1)for(var r=0;r<this.cols;r+=1)t+=this.data[e][r];return t}},{key:"colwiseSum",value:function(){for(var e=[],r=0;r<this.cols;r+=1){for(var n=0,o=0;o<this.rows;o+=1)n+=this.data[o][r];e[r]=[n]}return new t(1,this.cols,e)}},{key:"rowwiseSum",value:function(){for(var e=[],r=0;r<this.rows;r+=1){for(var n=0,o=0;o<this.rows;o+=1)n+=this.data[r][o];e[r]=[n]}return new t(this.rows,1,e)}},{key:"replicate",value:function(e,r){var n=this.data,o=[],i=null;if(1===e&&1===this.cols&&r>1){i=new t(this.rows,r);for(var u=0;u<this.rows;u+=1){o[u]=[];for(var c=0;c<r;c+=1)o[u][c]=n[u][0]}}else if(1===r&&1===this.rows&&e>1){i=new t(e,this.cols);for(var a=0;a<e;a+=1){o[a]=[];for(var s=0;s<this.cols;s+=1)o[a][s]=n[0][s]}}return i?(i.generateData(o),i):this}},{key:"transpose",value:function(){return N().execute("transpose",this)}},{key:"conjugate",value:function(){return this}},{key:"colMaxCoeffIndex",value:function(t){for(var e=-1,r=-1/0,n=0;n<this.rows;n+=1)this.data[n][t]>r&&(r=this.data[n][t],e=n);return e}},{key:"block",value:function(e,r,n,o){for(var i=[],u=e,c=0;u<this.rows&&u<e+n;u+=1,c+=1){i[u]=new Array(o);for(var a=r,s=0;a<this.cols&&a<r+o;a+=1,s+=1)i[c][s]=this.data[u][a]}return new t(n,o,i)}},{key:"col",value:function(e){for(var r=[],n=0;n<this.rows;n+=1)r[n]=[this.data[n][e]];return new t(this.rows,1,r)}},{key:"setCol",value:function(t,e){for(var r=0;r<this.rows;r+=1)this.data[r][t]=e.data[r][0];return this}},{key:"rollToColMatrix",value:function(){for(var e=[],r=0,n=0;n<this.rows;n+=1){e[n]=[];for(var o=0;o<this.cols;o+=1)e[r++][0]=this.data[n][o]}return new t(this.rows*this.cols,1,e)}}])&&u(e.prototype,r),t}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var p=new(require("gpu.js").GPU)({mode:"gpu"}),h=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=p.createKernel((function(t,e){return t[this.thread.x][this.thread.y]/e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new a(t.rows,t.cols,r(t.data,e.data))},b=function(t,e){var r=p.createKernel((function(t){return t[this.thread.x][this.thread.y]/this.constants.number})).setOutput([t.rows,t.cols]).setConstants({number:e});return new a(t.rows,t.cols,r(t.data))},v=function(t){var e=p.createKernel((function(t){return Math.exp(t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]),r=new a(t.rows,t.cols,e(t.data)),n=new a(1,t.cols,r.colwiseSum().data).replicate(t.rows,1);return new a(t.rows,t.cols,h(r,n).data)},d=function(t,e){var r=p.createKernel((function(t){return Math.log(t[this.thread.x][this.thread.y])})).setOutput([e.rows,e.cols]);return new a(t.rows,t.cols,C(t,new a(t.rows,t.cols,r(e.data))).data).sum()},w=function(t){var e=p.createKernel((function(t){return 1/(1+Math.exp(-t[this.thread.x][this.thread.y]))})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},m=function(t){var e=p.createKernel((function(t){return t[this.thread.x][this.thread.y]*(1-t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},g=function(t,e){var r=p.createKernel((function(t){return Math.log(t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]),n=p.createKernel((function(t){return 1-t[this.thread.x][this.thread.y]})).setOutput([t.rows,t.cols]),o=p.createKernel((function(t){return Math.log(1-t[this.thread.x][this.thread.y])})).setOutput([e.rows,e.cols]);return T(C(t,new a(t.rows,t.cols,r(t.data))),C(new a(t.rows,t.cols,n(t.data)),new a(e.rows,e.cols,o(e.data)))).sum()},O=function(t){var e=p.createKernel((function(t){return 2/(1+Math.exp(-2*t[this.thread.x][this.thread.y]))-1})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},S=function(t){var e=p.createKernel((function(t){return 1-Math.pow(2/(1+Math.exp(-2*t[this.thread.x][this.thread.y]))-1,2)})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},x=function(t){var e=p.createKernel((function(t){return Math.max(0,t[this.thread.x][this.thread.y])})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},j=function(t){var e=p.createKernel((function(t){return t[this.thread.x][this.thread.y]>0?1:0})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},k=function(t){var e=p.createKernel((function(t){return Math.log(1+Math.exp(t[this.thread.x][this.thread.y]))})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},P=function(t){var e=p.createKernel((function(t){return 1/(1+Math.exp(-t[this.thread.x][this.thread.y]))})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},_=function(t){var e=p.createKernel((function(t){return Math.pow(t[this.thread.x][this.thread.y],2)})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data)).sum()},R=function(t){var e=p.createKernel((function(t){return Math.sqrt(t[this.thread.x][this.thread.y]+1e-8)})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e(t.data))},E=function(t,e){var r=p.createKernel((function(t,e){return e[this.thread.x][this.thread.y]-Math.pow(t[this.thread.x][this.thread.y],2)})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,r(t.data)).sum()},W=function(t,e){if(t.cols!==e.rows)throw new Error("DIMENSIONS error. m1.cols ".concat(t.cols," !== m2.rows ").concat(e.rows,"."));var r=p.createKernel((function(t,e){for(var r=0,n=0;n<this.constants.cols;n++)r+=t[this.thread.x][n]*e[n][this.thread.y];return r})).setOutput([t.rows,e.cols]).setConstants({cols:t.rows});return new a(t.rows,e.cols,r(t.data,e.data))},T=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=p.createKernel((function(t,e){return t[this.thread.x][this.thread.y]+e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new a(t.rows,e.cols,r(t.data,e.data))},z=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=p.createKernel((function(t,e){return t[this.thread.x][this.thread.y]-e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new a(t.rows,e.cols,r(t.data,e.data))},D=function(t,e){var r=p.createKernel((function(){return(Math.random()-.5)*Math.sqrt(2/this.constants.parameter)})).setOutput([t.rows,t.cols]).setConstants({parameter:e});return new a(t.rows,t.cols,r())},M=function(t){var e=p.createKernel((function(){return 0})).setOutput([t.rows,t.cols]);return new a(t.rows,t.cols,e())},C=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");var r=p.createKernel((function(t,e){return t[this.thread.x][this.thread.y]*e[this.thread.x][this.thread.y]})).setOutput([t.rows,e.cols]);return new a(t.rows,e.cols,r(t.data,e.data))},K=function(t,e){var r=p.createKernel((function(t){return t[this.thread.x][this.thread.y]*this.constants.number})).setOutput([t.rows,t.cols]).setConstants({number:e});return new a(t.rows,t.cols,r(t.data))},L=function(t){var e=p.createKernel((function(t){return t[this.thread.y][this.thread.x]})).setOutput([t.cols,t.rows]);return new a(t.cols,t.rows,e(t.data))},B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=y(e);if(r){var o=y(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return l(this,t)});function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this)).addKernel("multiply",W),t.addKernel("elementWiseAdd",T),t.addKernel("elementWiseSubtract",z),t.addKernel("fillRandom",D),t.addKernel("setZeros",M),t.addKernel("elementWiseMultiply",C),t.addKernel("elementWiseMultiplyNumber",K),t.addKernel("elementWiseDivide",h),t.addKernel("elementWiseDivideNumber",b),t.addKernel("softmaxActivation",v),t.addKernel("softmaxLoss",d),t.addKernel("logisticActivation",w),t.addKernel("logisticDerivative",m),t.addKernel("logisticLoss",g),t.addKernel("tanhActivation",O),t.addKernel("tanhDerivative",S),t.addKernel("reluActivation",x),t.addKernel("reluDerivative",j),t.addKernel("softplusActivation",k),t.addKernel("softplusDerivative",P),t.addKernel("penalty",_),t.addKernel("sqrt",R),t.addKernel("purelinLoss",E),t.addKernel("transpose",L),t}return o}(o),A=new B,N=function(){return A};function F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const q=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Z(this,"dimensions",null),Z(this,"size",0),Z(this,"layers",[]),this.dimensions=e}var e,n;return e=t,(n=[{key:"addLayer",value:function(t){return this.size++,this.layers.push(t),this}},{key:"getLayers",value:function(){return this.layers}},{key:"forward",value:function(t){var e=t;return this.layers.forEach((function(t){e=t.forward(e)})),e}},{key:"backward",value:function(t,e,r,n){for(var o=t.cols,i=N().execute("elementWiseSubtract",r,e),u=this.layers.length-1;u>=0;u-=1)i=this.layers[u].getBackPropagation().propagate(t,o,n,i)}},{key:"loss",value:function(t,e){return this.layers[this.layers.length-1].loss(t,e)}},{key:"error",value:function(t){return this.layers[this.layers.length-1].error(t)}},{key:"save",value:function(t){var e={dimensions:this.dimensions,layers:[]};this.layers.forEach((function(t){e.layers.push({type:t.getType(),size:t.getSize(),weights:{W:t.W.data,b:t.b.data}})}));var n=JSON.stringify(e);return new Promise((function(e,o){r.writeFile(t,n,(function(t){t&&(console.error(t),o()),e(n)}))}))}}])&&F(e.prototype,n),t}();var H;function U(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}!function(t){t.logistic="logistic",t.softmax="softmax",t.tanh="tanh",t.relu="relu",t.softplus="softplus",t.conv="conv",t.maxpool="maxpool",t.fullyconnected="fullyconnected",t.purelin="purelin"}(H||(H={}));var I=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),U(this,"layer",null),U(this,"previousLayer",null),this.layer=e,this.previousLayer=r};function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function X(t,e){return X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},X(t,e)}function Q(t,e){if(e&&("object"===J(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}var $=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Y(n);if(o){var r=Y(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Q(this,t)});function u(){return V(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"propagate",value:function(t,e,r,n){var o=null!==this.previousLayer?this.previousLayer.A:t,i=N().execute("multiply",n,o.transpose().conjugate());return this.layer.gW=N().execute("elementWiseAdd",N().execute("elementWiseDivideNumber",i,e),N().execute("elementWiseMultiplyNumber",this.layer.W,r/e)),this.layer.gb=N().execute("elementWiseDivideNumber",n.rowwiseSum(),e),null!==this.previousLayer?N().execute("elementWiseMultiply",N().execute("multiply",this.layer.W.transpose(),n),this.previousLayer.derivative(this.previousLayer.A)):new a}}])&&G(e.prototype,r),u}(I);function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nt(t,e){return nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},nt(t,e)}function ot(t,e){if(e&&("object"===tt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function it(t){return it=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},it(t)}var ut=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nt(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=it(n);if(o){var r=it(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ot(this,t)});function u(){return et(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"propagate",value:function(t,e,r,n){return n}}])&&rt(e.prototype,r),u}(I);function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function at(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function st(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ft(t,e){return ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ft(t,e)}function lt(t,e){if(e&&("object"===ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return yt(t)}function yt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}function ht(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ft(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=pt(n);if(o){var r=pt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return lt(this,t)});function u(){var t;at(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ht(yt(t=i.call.apply(i,[this].concat(r))),"previousLayer",null),t}return e=u,(r=[{key:"propagate",value:function(t,e,r,n){for(var o=this.previousLayer,i=N().execute("setZeros",new a(o.Z.rows,o.Z.cols)),u=o.getFilterSize(),c=o.getStride(),s=o.getWidth(),f=o.getHeight(),l=(o.getDepth(),o.getOutputWidth()),y=o.getOutputHeight(),p=o.getOutputDepth(),h=0;h<e;h++)for(var b=0;b<p;b++)for(var v=0;v<y;v++)for(var d=0;d<l;d++){for(var w=c*d,m=-1/0,g=f*s*b,O=y*l*b,S=0,x=0,j=0,k=c*v;j<u;j++,k++)for(var P=0,_=w;P<u;P++,_++)m<o.Z.data[g+k*s+_][h]&&(m=o.Z.data[g+k*s+_][h],S=_,x=k);i.data[g+x*s+S][h]=n[O+v*l+d][h]}return i}}])&&st(e.prototype,r),u}(I);function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mt(t,e){return mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},mt(t,e)}function gt(t,e){if(e&&("object"===vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ot(t)}function Ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},St(t)}function xt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=St(n);if(o){var r=St(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return gt(this,t)});function u(){var t;dt(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return xt(Ot(t=i.call.apply(i,[this].concat(r))),"previousLayer",null),t}return e=u,(r=[{key:"propagate",value:function(t,e,r,n){var o=this.previousLayer,i=o.getPadding(),u=o.getStride(),c=o.getFilterSize(),s=o.getOutputWidth(),f=o.getOutputHeight(),l=o.getOutputDepth(),y=o.getWidth(),p=o.getHeight(),h=o.getDepth(),b=N().execute("setZeros",new a((y+2*i)*(p+2*i)*h,e)),v=new a(y*p*h,e);o.derivative(o.A),o.gW=N().execute("setZeros",o.gW),o.gb=N().execute("setZeros",o.gb);for(var d=0;d<e;d++){for(var w=0;w<l;w++)for(var m=0;m<f;m++)for(var g=0;g<s;g++){for(var O=u*m,S=u*g,x=0;x<h;x++)for(var j=0,k=O,P=-i;j<c;j++,k++,P++)for(var _=0,R=S,E=-i;_<c;_++,R++,E++){b[x*(y+2*i)*(p+2*i)+k*(y+2*i)+R][d]+=o.W.data[w][x*c*c+j*c+_]*n[w*s*f+m*s+g][d];var W=0;0==i?W=o.Z.data[x*y*p+k*y+R][d]:P>=0&&E>=0&&P<p&&E<y&&(W=o.Z.data[x*y*p+P*y+E][d]),o.gW.data[w][x*c*c+j*c+_]+=W*n[w*(s*f)+m*s+g][d]/e}o.gb.data[w][0]+=n[w*(s*f)+m*s+g][d]/e}if(i>0)for(var T=0;T<h;T++)for(var z=-i,D=0;z<p+i;z++,D++)for(var M=-i,C=0;M<y+i;M++,C++)M>=0&&z>=0&&M<y&&z<p&&(v[T*y*p+z*y+M][d]=b[T*(y+2*i)*(p+2*i)+D*(y+2*i)+C][d])}return i>0?v:b}}])&&wt(e.prototype,r),u}(I);function kt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Pt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"create",value:function(t,e){if(null==t){if(e.is1D())return new $(e,t);if(e.getType()==H.conv)return new ut(e,t)}else{if(t.getType()==H.maxpool)return new bt(e,t);if(t.getType()==H.conv)return new jt(e,t);if(t.is1D()||t.getType()==H.fullyconnected)return new $(e,t)}return null}}],null&&kt(e.prototype,null),r&&kt(e,r),t}();function _t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Et=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Rt(this,"dimensions",null),Rt(this,"lastLayer",null),Rt(this,"network",null),this.dimensions=e,this.network=new q(e)}var e,r;return e=t,r=[{key:"createLayer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new t;return"function"==typeof e&&e(r),null===this.lastLayer?this.firstLayerTransition(r):r.transition(this.lastLayer),r.configure(),r.setBackPropagation(Pt.create(this.lastLayer,r)),this.network.addLayer(r),this.lastLayer=r,this}},{key:"getNetwork",value:function(){return this.network}}],r&&_t(e.prototype,r),t}();function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var zt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Tt(this,"width",0),Tt(this,"height",0),Tt(this,"depth",0),Tt(this,"previousLayer",null),Tt(this,"backPropagation",null),this.W=new a,this.b=new a,this.A=new a,this.Z=new a,this.gW=new a,this.gb=new a,this.vW=new a,this.cW=new a,this.vb=new a,this.cb=new a}var e,r;return e=t,(r=[{key:"setBackPropagation",value:function(t){return this.backPropagation=t,this}},{key:"getBackPropagation",value:function(){return this.backPropagation}},{key:"forward",value:function(t){return this.Z=N().execute("elementWiseAdd",N().execute("multiply",this.W,t),this.b.replicate(1,t.cols)),this.A=this.activation(this.Z),this.A}},{key:"setWidth",value:function(t){return this.width=t,this}},{key:"getWidth",value:function(){return this.width}},{key:"setHeight",value:function(t){return this.height=t,this}},{key:"getHeight",value:function(){return this.height}},{key:"setDepth",value:function(t){return this.depth=t,this}},{key:"getDepth",value:function(){return this.depth}},{key:"transition",value:function(t){return this.previousLayer=t,this}},{key:"penalty",value:function(){return N().execute("penalty",this.W)}}])&&Wt(e.prototype,r),t}();function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kt(t,e,r){return Kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}},Kt(t,e,r||t)}function Lt(t,e){return Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Lt(t,e)}function Bt(t,e){if(e&&("object"===Dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return At(t)}function At(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nt(t){return Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Nt(t)}function Ft(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lt(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Nt(n);if(o){var r=Nt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Bt(this,t)});function u(){var t;Mt(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Ft(At(t=i.call.apply(i,[this].concat(r))),"depth",1),t}return e=u,(r=[{key:"configure",value:function(){this.W.resize(this.height,this.width),this.W=N().execute("fillRandom",this.W,this.width),this.b.resize(this.height,1),this.b=N().execute("fillRandom",this.b,this.width),this.gW.resize(this.height,this.width),this.gW=N().execute("setZeros",this.gW),this.gb.resize(this.height,1),this.gb=N().execute("setZeros",this.gb),this.cW.resize(this.height,this.width),this.cW=N().execute("setZeros",this.cW),this.cb.resize(this.height,1),this.cb=N().execute("setZeros",this.cb),this.vW.resize(this.height,this.width),this.vW=N().execute("setZeros",this.vW),this.vb.resize(this.height,1),this.vb=N().execute("setZeros",this.cb)}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){return t.is1D()?this.setWidth(t.getSize()):t.is3D()&&this.setWidth(t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth()),Kt(Nt(u.prototype),"transition",this).call(this,t),this}},{key:"setSize",value:function(t){return this.setHeight(t[0]),this}},{key:"getSize",value:function(){return this.height}},{key:"getOutputWidth",value:function(){return this.width}},{key:"getOutputHeight",value:function(){return this.height}},{key:"getOutputDepth",value:function(){return 1}}])&&Ct(e.prototype,r),u}(zt);function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function It(t,e){return It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},It(t,e)}function Jt(t,e){if(e&&("object"===qt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Vt(t)}var Gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Vt(n);if(o){var r=Vt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Jt(this,t)});function u(){return Ht(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"activation",value:function(t){return N().execute("softmaxActivation",t)}},{key:"derivative",value:function(t){throw new Error("Unsupported usage.")}},{key:"getType",value:function(){return H.softmax}},{key:"loss",value:function(t,e){return N().execute("softmaxLoss",t,e)}},{key:"error",value:function(t){return-1/t}}])&&Ut(e.prototype,r),u}(Zt);function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $t(t,e){return $t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},$t(t,e)}function te(t,e){if(e&&("object"===Xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ee(t){return ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ee(t)}var re=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$t(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ee(n);if(o){var r=ee(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return te(this,t)});function u(){return Qt(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"activation",value:function(t){return N().execute("logisticActivation",t)}},{key:"derivative",value:function(t){return N().execute("logisticDerivative",t)}},{key:"getType",value:function(){return H.logistic}},{key:"loss",value:function(t,e){return N().execute("logisticLoss",t,e)}},{key:"error",value:function(t){return-1/t}}])&&Yt(e.prototype,r),u}(Zt);function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ue(t,e){return ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ue(t,e)}function ce(t,e){if(e&&("object"===ne(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ae(t){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ae(t)}var se=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ae(n);if(o){var r=ae(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ce(this,t)});function u(){return oe(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"activation",value:function(t){return N().execute("tanhActivation",t)}},{key:"derivative",value:function(t){return N().execute("tanhDerivative",t)}},{key:"getType",value:function(){return H.tanh}},{key:"loss",value:function(t,e){return 0}},{key:"error",value:function(t){return 0}}])&&ie(e.prototype,r),u}(Zt);function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pe(t,e){return pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pe(t,e)}function he(t,e){if(e&&("object"===fe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function be(t){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},be(t)}var ve=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pe(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=be(n);if(o){var r=be(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return he(this,t)});function u(){return le(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"activation",value:function(t){return N().execute("reluActivation",t)}},{key:"derivative",value:function(t){return N().execute("reluDerivative",t)}},{key:"getType",value:function(){return H.relu}},{key:"loss",value:function(t,e){return 0}},{key:"error",value:function(t){return 0}}])&&ye(e.prototype,r),u}(Zt);function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function we(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ge(t,e){return ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ge(t,e)}function Oe(t,e){if(e&&("object"===de(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Se(t)}var xe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Se(n);if(o){var r=Se(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Oe(this,t)});function u(){return we(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"activation",value:function(t){return N().execute("softplusActivation",t)}},{key:"derivative",value:function(t){return N().execute("softplusDerivative",t)}},{key:"getType",value:function(){return H.softplus}},{key:"loss",value:function(t,e){return 0}},{key:"error",value:function(t){return 0}}])&&me(e.prototype,r),u}(Zt),je=function(t,e,r,n,o,i,u,c,s,f){for(var l=i*o*e,y=((n-i+2*c)/f+1)*((r-o+2*u)/s+1),p=0,h=N().execute("setZeros",new a(l,y)),b=-u;b+o<=r+u;b+=s)for(var v=-c;v+i<=n+c;v+=f){for(var d=0,w=0;w<e;w++)for(var m=r*n*w,g=0;g<o;g++)for(var O=0;O<i;O++)b+g>=0&&v+O>=0&&v+O<n&&b+g<r&&(h.data[d][p]=t.data[(g+b)*n+v+O+m][0]),d++;p++}return h},ke=function(t,e,r,n,o,i,u,c){for(var s=(n-i)/c+1,f=(r-o)/u+1,l=e,y=0,p=N().execute("setZeros",new a(s*f*l,1)),h=0;h+o<=r;h+=u)for(var b=0;b+i<=n;b+=c){for(var v=0;v<e;v++){for(var d=-1/0,w=r*n*v,m=s*f*v,g=0;g<o;g++)for(var O=0;O<i;O++)d=Math.max(d,t.data[w+(g+h)*n+b+O][0]);p.data[m+y][0]=d}y++}return new a};function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function _e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ee(t,e,r){return Ee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ze(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}},Ee(t,e,r||t)}function We(t,e){return We=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},We(t,e)}function Te(t,e){if(e&&("object"===Pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ze(t){return ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ze(t)}var De=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&We(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ze(n);if(o){var r=ze(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Te(this,t)});function u(){return _e(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"configure",value:function(){}},{key:"is1D",value:function(){return!1}},{key:"is3D",value:function(){return!0}},{key:"transition",value:function(t){return t.is3D()&&this.setSize([t.getOutputWidth(),t.getOutputHeight(),t.getOutputDepth()]),Ee(ze(u.prototype),"transition",this).call(this,t),this}},{key:"setSize",value:function(t){return this.setWidth(t[0]),this.setHeight(t[1]),this.setDepth(t[2]),this}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight(),this.getDepth()]}}])&&Re(e.prototype,r),u}(zt);function Me(t){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Me(t)}function Ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Le(t,e){return Le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Le(t,e)}function Be(t,e){if(e&&("object"===Me(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ae(t)}function Ae(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(t)}function Fe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ze=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Le(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ne(n);if(o){var r=Ne(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Be(this,t)});function u(){var t;Ce(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Fe(Ae(t=i.call.apply(i,[this].concat(r))),"numFilters",32),Fe(Ae(t),"filterSize",4),Fe(Ae(t),"padding",1),Fe(Ae(t),"stride",1),t}return e=u,(r=[{key:"configure",value:function(){this.W.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.W=N().execute("fillRandom",this.W,this.width*this.height*this.depth),this.b.resize(this.numFilters,1),this.b=N().execute("fillRandom",this.b,.01),this.gW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.gW=N().execute("setZeros",this.gW),this.gb.resize(this.numFilters,1),this.gb=N().execute("setZeros",this.gb),this.cW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.cW=N().execute("setZeros",this.gb),this.cb.resize(this.numFilters,1),this.cb=N().execute("setZeros",this.cb),this.vW.resize(this.numFilters,this.filterSize*this.filterSize*this.depth),this.vW=N().execute("setZeros",this.vW),this.vb.resize(this.numFilters,1),this.vb=N().execute("setZeros",this.vb)}},{key:"getOutputHeight",value:function(){return(this.width-this.filterSize+2*this.padding)/this.stride+1}},{key:"getOutputWidth",value:function(){return(this.height-this.filterSize+2*this.padding)/this.stride+1}},{key:"getOutputDepth",value:function(){return this.numFilters}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"getFilterSize",value:function(){return this.filterSize}},{key:"setNumFilters",value:function(t){return this.numFilters=t,this}},{key:"getNumFilters",value:function(){return this.numFilters}},{key:"setPadding",value:function(t){return this.padding=t,this}},{key:"getPadding",value:function(){return this.padding}},{key:"setStride",value:function(t){return this.stride=t,this}},{key:"getStride",value:function(){return this.stride}},{key:"forward",value:function(t){for(var e=new a(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth(),t.cols),r=0;r<t.cols;r+=1){var n=je(t.col(r),this.depth,this.height,this.width,this.filterSize,this.filterSize,this.padding,this.padding,this.stride,this.stride),o=this.Z=N().execute("elementWiseAdd",N().execute("multiply",this.W,n),this.b.replicate(1,t.cols)).rollToColMatrix();e.setCol(r,o)}return this.Z=e,this.activation(this.Z),this.A}},{key:"activation",value:function(t){return N().execute("reluActivation",t)}},{key:"derivative",value:function(t){return N().execute("reluDerivative",t)}},{key:"getType",value:function(){return H.conv}},{key:"loss",value:function(t,e){throw new Error("Unsupported.")}},{key:"error",value:function(t){throw new Error("Unsupported.")}}])&&Ke(e.prototype,r),u}(De);function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function He(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ie(t,e){return Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ie(t,e)}function Je(t,e){if(e&&("object"===qe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ve(t){return Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ve(t)}var Ge=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ie(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ve(n);if(o){var r=Ve(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Je(this,t)});function u(){return He(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"configure",value:function(){}},{key:"transition",value:function(t){if(!t.is3D())throw new Error("Invalid usage. Cannot fully connect with previous 1D layer.");if(t.getType()!=H.maxpool)throw new Error("Invalid usage. Cannot fully connect with previous non maxpool layer.");return this.filterSize=t.getOutputWidth(),this.padding=0,this.stride=1,this.width=t.getOutputWidth(),this.height=t.getOutputHeight(),this.depth=t.getOutputDepth(),this.numFilters=t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth(),this}},{key:"setSize",value:function(t){throw new Error("Unsupported")}},{key:"setFilterSize",value:function(t){throw new Error("Unsupported")}},{key:"setStride",value:function(t){throw new Error("Unsupported")}},{key:"setPadding",value:function(t){throw new Error("Unsupported")}},{key:"setWidth",value:function(t){throw new Error("Unsupported")}},{key:"setHeight",value:function(t){throw new Error("Unsupported")}},{key:"setDepth",value:function(t){throw new Error("Unsupported")}},{key:"setNumFilters",value:function(t){throw new Error("Unsupported")}}])&&Ue(e.prototype,r),u}(Ze);function Xe(t){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(t)}function Qe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $e(t,e){return $e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},$e(t,e)}function tr(t,e){if(e&&("object"===Xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function er(t){return er=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},er(t)}var rr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=er(n);if(o){var r=er(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return tr(this,t)});function u(){return Qe(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"configure",value:function(){this.backPropagation=new bt(this,this.previousLayer)}},{key:"getOutputHeight",value:function(){return(this.height-this.filterSize)/this.stride+1}},{key:"getOutputWidth",value:function(){return(this.width-this.filterSize)/this.stride+1}},{key:"getOutputDepth",value:function(){return this.depth}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"getFilterSize",value:function(){return this.filterSize}},{key:"setStride",value:function(t){return this.stride=t,this}},{key:"getStride",value:function(){return this.stride}},{key:"forward",value:function(t){for(var e=new a(this.getOutputWidth()*this.getOutputHeight()*this.getOutputDepth(),t.cols),r=0;r<t.cols;r+=1){var n=ke(t.col(r),this.depth,this.height,this.width,this.filterSize,this.filterSize,this.stride,this.stride).rollToColMatrix();e.setCol(r,n)}return this.Z=e,this.activation(this.Z),this.A}},{key:"activation",value:function(t){throw new Error("No activation for MAXPOOL layer.")}},{key:"derivative",value:function(t){throw new Error("No derivative for MAXPOOL layer.")}},{key:"getType",value:function(){return H.maxpool}},{key:"loss",value:function(t,e){throw new Error("Unsupported.")}},{key:"error",value:function(t){throw new Error("Unsupported.")}}])&&Ye(e.prototype,r),u}(De);function nr(t){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nr(t)}function or(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ir(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ur(t,e){return ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ur(t,e)}function cr(t,e){if(e&&("object"===nr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ar(t){return ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ar(t)}var sr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ur(t,e)}(a,t);var e,n,o,i,u,c=(i=a,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ar(i);if(u){var r=ar(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return cr(this,t)});function a(){return or(this,a),c.apply(this,arguments)}return e=a,o=[{key:"fromJSON",value:function(t){return new Promise((function(e,n){r.readFile(t,(function(t,r){if(t)n(t);else{var o=JSON.parse(r.toString()),i=new a(o.dimensions);o.layers.forEach((function(t){var e=null;"logistic"===t.type?e=re:"softmax"===t.type?e=Gt:"relu"===t.type?e=ve:"softplus"===t.type?e=xe:"tanh"===t.type&&(e=se),i.createLayer(e,(function(e){e.setSize(t.dimensions)}))}));var u=i.getNetwork();u.getLayers().forEach((function(t,e){t.W=o.layers.W,t.b=o.layers.b})),e(u)}}))}))}}],(n=[{key:"firstLayerTransition",value:function(t){t.setWidth(this.dimensions[0])}}])&&ir(e.prototype,n),o&&ir(e,o),a}(Et);function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function lr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pr(t,e){return pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pr(t,e)}function hr(t,e){if(e&&("object"===fr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function br(t){return br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},br(t)}var vr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pr(t,e)}(a,t);var e,n,o,i,u,c=(i=a,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=br(i);if(u){var r=br(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return hr(this,t)});function a(){return lr(this,a),c.apply(this,arguments)}return e=a,o=[{key:"fromJSON",value:function(t){return new Promise((function(e,n){r.readFile(t,(function(t,r){if(t)n(t);else{var o=JSON.parse(r.toString()),i=new a(o.dimensions);o.layers.forEach((function(t){var e=null;"logistic"===t.type?(e=re,i.createLayer(e,(function(e){e.setSize(t.dimensions)}))):"softmax"===t.type?(e=Gt,i.createLayer(e,(function(e){e.setSize(t.dimensions)}))):"relu"===t.type?(e=ve,i.createLayer(e,(function(e){e.setSize(t.dimensions)}))):"softplus"===t.type?(e=xe,i.createLayer(e,(function(e){e.setSize(t.dimensions)}))):"tanh"===t.type?(e=se,i.createLayer(e,(function(e){e.setSize(t.dimensions)}))):"conv"===t.type?(e=Ze,i.createLayer(e,(function(e){e.setSize(t.dimensions),e.setFilterSize(t.filterSize),e.setStride(t.stride),e.setNumFilters(t.numFilters),e.setPadding(t.padding)}))):"maxpool"===t.type?(e=rr,i.createLayer(e,(function(e){e.setSize(t.dimensions),e.setFilterSize(t.filterSize),e.setStride(t.stride)}))):"fullyconnected"===t.type&&(e=rr,i.createLayer(e))}));var u=i.getNetwork();u.getLayers().forEach((function(t,e){t.W=o.layers.W,t.b=o.layers.b})),e(u)}}))}))}}],(n=[{key:"firstLayerTransition",value:function(t){t.setSize(this.dimensions)}}])&&yr(e.prototype,n),o&&yr(e,o),a}(Et);function dr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mr=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),wr(this,"exampleSize",0),wr(this,"numberOfExamples",0),wr(this,"data",null),this.exampleSize=e,this.numberOfExamples=r;for(var o=[],i=0;i<r;i+=1){o[i]=[];for(var u=0;u<e;u+=1)o[i][u]=n[i][u].length?Number(n[i][u]):NaN}this.data=new a(this.exampleSize,this.numberOfExamples,o)}var e,r;return e=t,(r=[{key:"exampleAt",value:function(t){return this.data.col(t)}},{key:"getNumberOfExamples",value:function(){return this.numberOfExamples}},{key:"getBatch",value:function(t,e){return this.data.block(0,t,this.data.rows,e)}}])&&dr(e.prototype,r),t}();const gr=require("csvtojson");function Or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Sr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"fromCSV",value:function(t){return new Promise((function(e){gr({noheader:!0,output:"csv"}).fromFile(t).then((function(t){var r=t.length,n=t[0].length,o=new mr(n,r,t);e(o)}))}))}}],null&&Or(e.prototype,null),r&&Or(e,r),t}();function xr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),jr(this,"batchSize",0),jr(this,"t",0),jr(this,"learningRate",0)}var e,r;return e=t,(r=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}}])&&xr(e.prototype,r),t}();function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function _r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Er(t,e){return Er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Er(t,e)}function Wr(t,e){if(e&&("object"===Pr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Tr(t){return Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tr(t)}var zr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Er(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Tr(n);if(o){var r=Tr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Wr(this,t)});function u(){return _r(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"optimize",value:function(t){this.adam(t,this.learningRate,this.t)}},{key:"adam",value:function(t,e,r){var n=.9,o=.999;t.vW=N().execute("elementWiseAdd",N().execute("elementWiseMultiplyNumber",t.vW,n),N().execute("elementWiseMultiplyNumber",t.gW,1-n));var i=N().execute("elementWiseDivideNumber",t.vW,1-Math.pow(n,r));t.cW=N().execute("elementWiseAdd",N().execute("elementWiseMultiplyNumber",t.cW,n),N().execute("elementWiseMultiplyNumber",t.gW,1-n));var u=N().execute("sqrt",N().execute("elementWiseMultiplyNumber",t.cW,1-Math.pow(o,r)));t.W=N().execute("elementWiseSubtract",t.W,N().execute("elementWiseMultiplyNumber",N().execute("elementWiseMultiply",i,u),e)),t.vb=N().execute("elementWiseAdd",N().execute("elementWiseMultiplyNumber",t.vb,n),N().execute("elementWiseMultiplyNumber",t.gb,1-n));var c=N().execute("elementWiseDivideNumber",t.vb,1-Math.pow(n,r));t.cb=N().execute("elementWiseAdd",N().execute("elementWiseMultiplyNumber",t.cb,o),N().execute("elementWiseMultiplyNumber",N().execute("elementWiseMultiply",t.gb,t.gb),1-o));var a=N().execute("sqrt",N().execute("elementWiseDivideNumber",t.cb,1-Math.pow(o,r)));t.b=N().execute("elementWiseSubtract",t.b,N().execute("elementWiseMultiplyNumber",N().execute("elementWiseDivide",c,a),e))}}])&&Rr(e.prototype,r),u}(kr);function Dr(t){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dr(t)}function Mr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kr(t,e){return Kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Kr(t,e)}function Lr(t,e){if(e&&("object"===Dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Br(t){return Br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Br(t)}var Ar=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kr(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Br(n);if(o){var r=Br(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Lr(this,t)});function u(){return Mr(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"optimize",value:function(t){this.gradientDescent(t,this.learningRate)}},{key:"gradientDescent",value:function(t,e){t.W=N().execute("elementWiseSubtract",t.W,N().execute("elementWiseMultiplyNumber",t.gW,e)),t.b=N().execute("elementWiseSubtract",t.b,N().execute("elementWiseMultiplyNumber",t.gb,e))}}])&&Cr(e.prototype,r),u}(kr);function Nr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Fr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Zr=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Fr(this,"network",null),Fr(this,"optimizer",null),Fr(this,"regularization",0),Fr(this,"iterations",1e3),Fr(this,"learningRate",.1),Fr(this,"verbose",!0),Fr(this,"verboseStep",1),Fr(this,"stepCallback",Function),this.network=e,this.optimizer=r}var e,r;return e=t,r=[{key:"setRegularization",value:function(t){return this.regularization=t,this}},{key:"setIterations",value:function(t){return this.iterations=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}},{key:"setVerbose",value:function(t){return this.verbose=t,this}},{key:"setVerboseStep",value:function(t){return this.verboseStep=t,this}},{key:"setStepCallback",value:function(t){return this.stepCallback=t,this}},{key:"cost",value:function(t,e){var r=100,n=t.getNumberOfExamples(),o=Math.ceil(n/r),i=0,u=0,c=0;this.network.getLayers().forEach((function(t){c+=t.penalty()}));for(var a=0,s=0;a<n;a+=r,s+=1){var f=this.network.forward(t.getBatch(s,r)),l=e.getBatch(s,r),y=l.cols,p=this.network.loss(l,f);i+=(this.network.error(y)*p+this.regularization*c/(2*y))/(o*(y/r));for(var h=0;h<f.cols;h+=1)f.colMaxCoeffIndex(h)==f.colMaxCoeffIndex(h)&&u++}return{cost:i,accuracy:(u-1)/n*100}}}],r&&Nr(e.prototype,r),t}();function qr(t){return qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qr(t)}function Hr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ir(t,e){return Ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ir(t,e)}function Jr(t,e){if(e&&("object"===qr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Vr(t)}function Vr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gr(t){return Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Gr(t)}function Xr(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Qr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ir(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Gr(n);if(o){var r=Gr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Jr(this,t)});function u(){var t;Hr(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Xr(Vr(t=i.call.apply(i,[this].concat(r))),"batchSize",100),t}return e=u,(r=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"train",value:function(t,e){var r=this,n=t.getNumberOfExamples(),o=(new Date).getTime(),i=0;this.optimizer.setBatchSize(this.batchSize);for(var u=0;u<this.iterations;u+=1){for(var c=(new Date).getTime(),a=0,s=0;a<n;a+=this.batchSize,s+=this.batchSize){var f=(new Date).getTime(),l=t.getBatch(s,this.batchSize),y=e.getBatch(s,this.batchSize),p=this.network.forward(l);if(this.network.backward(l,y,p,this.regularization),this.network.getLayers().forEach((function(t){r.optimizer.setT(++i),r.optimizer.optimize(t)})),this.verbose){var h=(new Date).getTime();console.log("Batch: ".concat(s," / ").concat(n," | Time: ").concat(h-f," ms | ").concat(h-c," ms."))}}if(this.verbose&&(u+1)%this.verboseStep==0){var b=(new Date).getTime(),v=this.cost(t,e);console.log("Iteration: ".concat(u+1," | Cost: ").concat(v.cost," | Accuracy: ").concat(v.accuracy,"% | Time: ").concat(b-o," ms."))}"function"==typeof this.stepCallback&&this.stepCallback({iteration:u})}}}])&&Ur(e.prototype,r),u}(Zr);function Yr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $r=function(){function t(e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(r="dataset")in this?Object.defineProperty(this,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[r]=null,this.dataset=e}var e,r;return e=t,(r=[{key:"apply",value:function(){for(var t=0;t<this.dataset.getNumberOfExamples();t+=1)this.applyToExample(t);return this.dataset}}])&&Yr(e.prototype,r),t}();function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nn(t,e){return nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},nn(t,e)}function on(t,e){if(e&&("object"===tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return un(t)}function un(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cn(t){return cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cn(t)}function an(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sn(t){return sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sn(t)}function fn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yn(t,e){return yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yn(t,e)}function pn(t,e){if(e&&("object"===sn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function hn(t){return hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},hn(t)}function bn(t){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bn(t)}function vn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wn(t,e){return wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},wn(t,e)}function mn(t,e){if(e&&("object"===bn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return gn(t)}function gn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function On(t){return On=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},On(t)}function Sn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function jn(t,e){return jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},jn(t,e)}function kn(t,e){if(e&&("object"===xn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pn(t){return Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Pn(t)}var _n=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]/e.data[n][o]}return new a(t.rows,e.cols,r)},Rn=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]/e}return new a(t.rows,t.cols,r)},En=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=Math.exp(t.data[r][n])}var o=new a(t.rows,t.cols,e),i=new a(1,t.cols,o.colwiseSum().data).replicate(t.rows,1);return new a(t.rows,t.cols,_n(o,i).data)},Wn=function(t,e){for(var r=[],n=0;n<e.rows;n+=1){r[n]=[];for(var o=0;o<e.cols;o+=1)r[n][o]=Math.log(e.data[n][o])}return new a(t.rows,t.cols,Vn(t,new a(t.rows,t.cols,r)).data).sum()},Tn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=1/(1+Math.exp(-t.data[r][n]))}return new a(t.rows,t.cols,e)},zn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=t.data[r][n]*(1-t.data[r][n])}return new a(t.rows,t.cols,e)},Dn=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=Math.log(t.data[n][o])}for(var i=new a(t.rows,t.cols,r),u=[],c=0;c<t.rows;c+=1){u[c]=[];for(var s=0;s<t.cols;s+=1)u[c][s]=1-t.data[c][s]}for(var f=new a(t.rows,t.cols,u),l=[],y=0;y<e.rows;y+=1){l[y]=[];for(var p=0;p<e.cols;p+=1)l[y][p]=Math.log(1-e.data[y][p])}var h=new a(e.rows,e.cols,l);return Hn(Vn(t,i),Vn(f,h)).sum()},Mn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=2/(1+Math.exp(-2*t.data[r][n]))-1}return new a(t.rows,t.cols,e)},Cn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=1-Math.pow(2/(1+Math.exp(-2*t.data[r][n]))-1,2)}return new a(t.rows,t.cols,e)},Kn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=Math.max(0,t.data[r][n])}return new a(t.rows,t.cols,e)},Ln=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=t.data[r][n]>0?1:0}return new a(t.rows,t.cols,e)},Bn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=Math.log(1+Math.exp(t.data[r][n]))}return new a(t.rows,t.cols,e)},An=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=1/(1+Math.exp(-Math.log(1+Math.exp(t.data[r][n]))))}return new a(t.rows,t.cols,e)},Nn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=Math.pow(t.data[r][n],2)}return new a(t.rows,t.cols,e).sum()},Fn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=Math.sqrt(t.data[r][n]+1e-8)}return new a(t.rows,t.cols,e)},Zn=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]-Math.pow(e[n][o],2)}return new a(t.rows,t.cols,r).sum()},qn=function(t,e){if(t.cols!==e.rows)throw new Error("DIMENSIONS error. m1.cols ".concat(t.cols," !== m2.rows ").concat(e.rows,"."));for(var r=[],n=0;n<t.rows;++n){r[n]=new Array(e.cols);for(var o=0;o<e.cols;++o){r[n][o]=0;for(var i=0;i<t.cols;++i)r[n][o]+=t.data[n][i]*e.data[i][o]}}return new a(t.rows,e.cols,r)},Hn=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]+e.data[n][o]}return new a(t.rows,t.cols,r)},Un=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]-e.data[n][o]}return new a(t.rows,t.cols,r)},In=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=(Math.random()-.5)*Math.sqrt(2/e)}return new a(t.rows,t.cols,r)},Jn=function(t){for(var e=[],r=0;r<t.rows;r+=1){e[r]=[];for(var n=0;n<t.cols;n+=1)e[r][n]=0}return new a(t.rows,t.cols,e)},Vn=function(t,e){if(t.rows!==e.rows)throw new Error("ROWS number not equal.");if(t.cols!==e.cols)throw new Error("COLS number not equal.");for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]*e.data[n][o]}return new a(t.rows,t.cols,r)},Gn=function(t,e){for(var r=[],n=0;n<t.rows;n+=1){r[n]=[];for(var o=0;o<t.cols;o+=1)r[n][o]=t.data[n][o]*e}return new a(t.rows,t.cols,r)},Xn=function(t){for(var e=[],r=0;r<t.cols;r+=1){e[r]=[];for(var n=0;n<t.rows;n+=1)e[r][n]=t.data[n][r]}return new a(t.rows,t.cols,e)},Qn={Builder1D:sr,Builder3D:vr},Yn={Matrix:a},$n={SoftmaxLayer:Gt,LogisticLayer:re,ReluLayer:ve,SoftplusLayer:xe,TanhLayer:se,ConvLayer:Ze,MaxPoolLayer:rr,FullyConnectedLayer:Ge},to={DatasetBuilder:Sr},eo={OptimizerAdam:zr,OptimizerGradientDescent:Ar},ro={MiniBatchTrainer:Qr},no={CallbackDatabaseModifier:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nn(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=cn(n);if(o){var r=cn(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return on(this,t)});function u(){var t;en(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return an(un(t=i.call.apply(i,[this].concat(r))),"callback",(function(t){return t})),t}return e=u,(r=[{key:"applyToExample",value:function(t){for(var e=0;e<this.dataset.getNumberOfExamples();e+=1)for(var r=this.callback(this.dataset.exampleAt(e)),n=0;n<this.dataset.data.data.rows;n+=1)this.dataset.data.data[n][e]=r.data.data[n][0]}},{key:"setCallback",value:function(t){return this.callback=t,this}}])&&rn(e.prototype,r),u}($r),MinMaxScalingDatabaseModifier:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yn(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=hn(n);if(o){var r=hn(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return pn(this,t)});function u(){return fn(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"applyToExample",value:function(t){for(var e=1/0,r=-1/0,n=0;n<this.dataset.getNumberOfExamples();n+=1)for(var o=this.dataset.exampleAt(n),i=0;i<o.rows;i+=1)e=Math.min(o.data[i][0]),r=Math.max(o.data[i][0]);var u=p.createKernel((function(t){return(t[this.thread.x][this.thread.y]-this.constants.min)/(this.constants.max-this.constants.min)})).setOutput([this.dataset.data.data.rows,this.dataset.data.data.cols]).setConstants({min:e,max:r});this.dataset.data.data=u(this.dataset.data.data)}}])&&ln(e.prototype,r),u}($r),MissingDataScalingDatabaseModifier:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wn(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=On(n);if(o){var r=On(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return mn(this,t)});function u(){var t;vn(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Sn(gn(t=i.call.apply(i,[this].concat(r))),"modificationType","mean"),t}return e=u,(r=[{key:"applyToExample",value:function(t){for(var e=this,r=[],n=0,o=0,i=0,u=0;u<this.dataset.getNumberOfExamples();u+=1)for(var c=this.dataset.exampleAt(u),a=0;a<c.data.rows;a+=1)isNaN(c[a][0])?r.push({row:a,col:c}):(o+=c[a][0],n++);"mean"===this.modificationType&&(i=o/n),r.forEach((function(t){var r=t.row,n=t.col;e.dataset.data.data[r][n]=i}))}},{key:"setModificationType",value:function(t){return this.modificationType=t,this}}])&&dn(e.prototype,r),u}($r)},oo={ComputationCPU:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jn(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Pn(e);if(r){var o=Pn(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return kn(this,t)});function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this)).addKernel("multiply",qn),t.addKernel("elementWiseAdd",Hn),t.addKernel("elementWiseSubtract",Un),t.addKernel("fillRandom",In),t.addKernel("setZeros",Jn),t.addKernel("elementWiseMultiply",Vn),t.addKernel("elementWiseMultiplyNumber",Gn),t.addKernel("elementWiseDivide",_n),t.addKernel("elementWiseDivideNumber",Rn),t.addKernel("softmaxActivation",En),t.addKernel("softmaxLoss",Wn),t.addKernel("logisticActivation",Tn),t.addKernel("logisticDerivative",zn),t.addKernel("logisticLoss",Dn),t.addKernel("tanhActivation",Mn),t.addKernel("tanhDerivative",Cn),t.addKernel("reluActivation",Kn),t.addKernel("reluDerivative",Ln),t.addKernel("softplusActivation",Bn),t.addKernel("softplusDerivative",An),t.addKernel("penalty",Nn),t.addKernel("sqrt",Fn),t.addKernel("purelinLoss",Zn),t.addKernel("transpose",Xn),t}return o}(o),ComputationGPU:B,setComputation:function(t){A=t}};module.exports=e})();
//# sourceMappingURL=impulse-ts.js.map